{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Root Access: IaC Homelab from Scratch","text":"<p>Quick Overview</p> <p>What: The prologue and campaign map for your Homelab IaC journey. Why: Sets the stage, defines acronyms, and guides you through levels. Time: Self-paced; skim in 5\u201310 minutes. XP: +20 (like Whose Line, the points are made up but the fun is real).</p> <p>DAT \u2014 Define Acronyms &amp; Terms. See the Glossary for full definitions. Acronyms like IaC, CI/CD, PBS, and others will show hover definitions automatically.</p> <p>Welcome to the Ops Manual \u2014 your field guide for hacking together a homelab from the ground up. Start from your laptop, progress through levels, and evolve into a fully automated on\u2011prem fortress. Each step is a quest to build, configure, and conquer your infrastructure with IaC.</p>"},{"location":"#what-we-mean-by-workstation","title":"\ud83d\udda5\ufe0f What We Mean by \"Workstation\"","text":"<p>In this quest, your workstation is the rig you\u2019ll wield to initiate your homelab exploits. It could be a desktop, laptop, or PC \u2014 whatever hardware you have in your digital arsenal. No need for a supercomputer; we start with what you\u2019ve got and level up from there.</p>"},{"location":"#campaign-map","title":"\ud83d\ude80 Campaign Map","text":"<ol> <li>\ud83d\udda5\ufe0f Hardware</li> <li>\ud83d\udcbb Workstation Setup</li> <li>\u2601\ufe0f Cloud Accounts &amp; Foundations</li> <li>\ud83c\udf10 Network Setup</li> <li>\ud83d\uddc4\ufe0f NAS Setup</li> <li>\ud83d\udda7 Proxmox Cluster Setup</li> </ol> <p>Chapters 07+ are coming soon and will unlock as the campaign progresses.</p>"},{"location":"#do-you-want-to-know-more","title":"\u2753 Do You Want To Know More?","text":"<ul> <li>\ud83d\udcd6 Glossary \u2014 DAT: your hacker\u2019s codex for all acronyms, jargon, slang, and domain terms.</li> <li>\ud83d\udcda Runbooks \u2014 step-by-step exploits and procedures.</li> <li>\ud83d\udd00 Migration \u2014 strategies for shifting workloads to new hardware nodes.</li> <li>\ud83e\udded Control Plane \u2014 cloud-hosted orchestration &amp; services.</li> </ul>"},{"location":"#project-details","title":"\ud83d\udd27 Project Details","text":"<p>This manual is powered by MkDocs Material and GitHub Pages \u2014 think of it as the console where we write our ops logs.</p> <p>Contributions are welcome! See the GitHub repo: MichaelHeaton/homelab-infra.</p> <p>\ud83c\udfae This isn\u2019t just documentation\u2014it\u2019s your quest log. Each page is a mission. Ready? Let\u2019s begin.</p> <p>\ud83c\udf89 Campaign Prologue Complete! You\u2019re ready to begin your first quest. XP earned: 20 (like Whose Line, the points are made up but the fun is real).</p> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"01-Hardware/","title":"Hardware","text":"<p>Quick Overview</p> <p>What: Choose and prepare the physical gear for your homelab. Why: Hardware is the bedrock \u2014 without it, nothing else works. Time: 30\u201360 minutes to review, longer if buying hardware. XP: Up to 70 points (like Whose Line, the points are made up but the fun is real).</p>"},{"location":"01-Hardware/#entry-checks","title":"Entry Checks","text":"<p>Before proceeding, ensure you have:</p> <ul> <li>Administrative access to your network and hardware.</li> <li>A planned budget for purchasing or upgrading hardware.</li> <li>Adequate physical space and power availability for your equipment.</li> <li>Basic understanding of virtualization and networking concepts.</li> </ul>"},{"location":"01-Hardware/#outcomes","title":"Outcomes","text":"<p>By the end of this chapter, you will be able to:</p> <ul> <li>Determine the hardware requirements for your workstation.</li> <li>Understand the specifications needed for Proxmox Nodes.</li> <li>Identify suitable NAS/Storage solutions for reliability and performance.</li> <li>Plan and configure networking hardware and VLAN segmentation.</li> <li>Understand domain name usage and SSL certificate requirements.</li> <li>Recognize the importance of a public IP or dynamic DNS service.</li> <li>Select appropriate power management solutions for your setup.</li> </ul> <p>Your homelab starts with hardware. From workstation to power protection, this chapter helps you choose and prepare the foundation for everything else.</p>"},{"location":"01-Hardware/#11-workstation-requirements","title":"1.1 Workstation Requirements","text":"<p>A workstation acts as your primary interface for developing, configuring, and managing your homelab. This lab helps you review the minimum and recommended workstation hardware specifications.</p>"},{"location":"01-Hardware/#workstation-hardware-requirements","title":"Workstation Hardware Requirements","text":"Resource Minimum Recommended RAM 8 GB RAM 16+ GB RAM CPU Dual-core CPU Quad-core or higher CPU Storage 128 GB SSD 256+ GB SSD/NVMe <p>Operating System Support: Windows, macOS, Linux Package managers such as Homebrew (macOS package manager) and Chocolatey (Windows package manager) simplify software installation.</p>"},{"location":"01-Hardware/#validation","title":"Validation","text":"<ul> <li> I have identified a workstation that meets or exceeds the minimum hardware requirements.</li> <li> I understand the recommended specifications for better performance.</li> <li> My workstation's operating system supports the necessary software tools. <p>\ud83c\udfc6 Achievement Unlocked: Your workstation meets the challenge!</p> </li> </ul>"},{"location":"01-Hardware/#12-proxmox-nodes-specifications","title":"1.2 Proxmox Nodes Specifications","text":"<p>Proxmox Nodes provide the compute power and virtualization capabilities to run multiple workloads. This lab reviews the hardware needed to build effective Proxmox Nodes.</p>"},{"location":"01-Hardware/#proxmox-node-hardware-requirements","title":"Proxmox Node Hardware Requirements","text":"Resource Minimum Recommended RAM 8 GB RAM 32+ GB RAM CPU Dual-core CPU Quad-core or higher CPU Storage Type Basic storage SSD/NVMe storage (prefer enterprise-grade) Storage Size 128 GB+ disk size 500 GB+ disk size Networking 1 GbE NIC 10 GbE or multiple bonded NICs Network Interface Cards (NICs) 1 NIC Multiple NICs <p>Optional Upgrades:</p> <ul> <li>Increase NIC count for better network segmentation and redundancy.</li> <li>Add GPUs for hardware acceleration and GPU passthrough.</li> </ul>"},{"location":"01-Hardware/#validation_1","title":"Validation","text":"<ul> <li> I have reviewed the minimum and recommended hardware for Proxmox Nodes.</li> <li> I have identified or planned for nodes that meet these specifications.</li> <li> I understand optional upgrades and their benefits. <p>\ud83c\udfc6 Achievement Unlocked: Proxmox nodes powered up!</p> </li> </ul>"},{"location":"01-Hardware/#13-nasstorage-solutions","title":"1.3 NAS/Storage Solutions","text":"<p>Reliable storage is essential for data protection, backups, and fast file access. This lab helps you evaluate NAS and Storage options suitable for your homelab.</p>"},{"location":"01-Hardware/#nasstorage-hardware-requirements","title":"NAS/Storage Hardware Requirements","text":"Resource Minimum Recommended Protocol Support NFS (Network File System) or SMB (Server Message Block) support NFS and iSCSI support Device Basic NFS-capable device NAS with multiple drive bays Network Interface 1 GbE network interface 10 GbE networking RAID Support Optional Required (RAID 1/5/6/10, etc.) NIC Count and Speed 1 x 1 GbE 2+ x 1/10 GbE Expansion Options Not required Support for expansion units or JBOD"},{"location":"01-Hardware/#validation_2","title":"Validation","text":"<ul> <li> I have reviewed the NAS/Storage protocols and device options.</li> <li> I have identified storage solutions that meet my data reliability and performance needs.</li> <li> I understand the importance of RAID and network interfaces for redundancy and throughput. <p>\ud83c\udfc6 Achievement Unlocked: Storage fortress secured!</p> </li> </ul>"},{"location":"01-Hardware/#14-networking-hardware-and-vlans","title":"1.4 Networking Hardware and VLANs","text":"<p>Networking hardware enables segmentation, security, and performance optimization. This lab covers the selection of switches, VLAN configuration, and network protocols.</p>"},{"location":"01-Hardware/#vlan-example-table","title":"VLAN Example Table","text":"VLAN ID Name Purpose Minimum Devices Recommended Devices 10 Management Network device management Optional Separate VLAN for management 20 Workstations User devices Optional Separate VLAN for workstations 30 Servers Homelab servers Optional Separate VLAN for servers 40 IoT Internet of Things devices Optional Isolated VLAN for IoT <p>Additional Notes:</p> <ul> <li>Managed switches from UniFi, Cisco, or Netgear are recommended.</li> <li>Software options such as UniFi (default in this lab), pfSense, or OPNsense can handle routing and firewall duties.</li> <li>Use RJ45 (Ethernet connector) with Cat6 or better for copper; SFP/SFP+ modules and fiber for higher speeds or longer distances.</li> <li>Port forwarding and firewall rules are essential for secure external access.</li> <li>Consider PoE (Power over Ethernet) capable switches if you plan to power APs or cameras.</li> </ul>"},{"location":"01-Hardware/#validation_3","title":"Validation","text":"<ul> <li> I have reviewed VLAN segmentation best practices.</li> <li> I have identified networking hardware that supports my VLAN and performance requirements.</li> <li> I understand how to configure port forwarding and firewall rules. <p>\ud83c\udfc6 Achievement Unlocked: Network pathways established!</p> </li> </ul>"},{"location":"01-Hardware/#15-domain-names-and-ssl-certificates","title":"1.5 Domain Names and SSL Certificates","text":"<p>Domain names allow external and internal access to homelab services. This lab reviews public and private domain usage and SSL (Secure Sockets Layer) certificate considerations.</p>"},{"location":"01-Hardware/#key-points","title":"Key Points","text":"<ul> <li>Public domain names require valid SSL certificates (e.g., via Let's Encrypt or Cloudflare DNS-01).</li> <li>Private domains often use self-signed certificates or internal certificate authorities (CAs), requiring client configuration.</li> <li>Choose domain types based on access scope and security needs.</li> <li>SSL/TLS certificates should be automated where possible using ACME (Automated Certificate Management Environment) clients.</li> </ul>"},{"location":"01-Hardware/#validation_4","title":"Validation","text":"<ul> <li> I understand the difference between public and private domain names.</li> <li> I have planned for SSL certificate acquisition or management.</li> <li> I know how to configure certificates for secure connections. <p>\ud83c\udfc6 Achievement Unlocked: Domain identity claimed!</p> </li> </ul>"},{"location":"01-Hardware/#16-public-ip-and-dynamic-dns","title":"1.6 Public IP and Dynamic DNS","text":"<p>Remote access to your homelab requires a static public IP or dynamic DNS service. This lab covers verifying your public IP and assessing internet speed.</p>"},{"location":"01-Hardware/#verification-commands","title":"Verification Commands","text":"<pre><code>curl -s ifconfig.me\ncurl -s https://ipinfo.io\n</code></pre>"},{"location":"01-Hardware/#speed-test-options","title":"Speed Test Options","text":"<pre><code>speedtest-cli\n# or\ncurl -s https://raw.githubusercontent.com/sivel/speedtest-cli/master/speedtest.py | python -\n</code></pre>"},{"location":"01-Hardware/#additional-notes","title":"Additional Notes","text":"<ul> <li>ISPs often provide asymmetric connections; upload speed is critical for hosting.</li> <li>Dynamic DNS services like DuckDNS, No-IP, or Cloudflare map changing IPs to fixed domain names.</li> <li>Consider IPv6 support for future-proofing and broader compatibility.</li> <li>For homelabs behind CGNAT, a VPN or tunneling service may be required for external access.</li> </ul>"},{"location":"01-Hardware/#validation_5","title":"Validation","text":"<ul> <li> I have verified my public IP address or set up dynamic DNS.</li> <li> I have tested my internet upload and download speeds.</li> <li> I understand the impact of internet speed on hosting services. <p>\ud83c\udfc6 Achievement Unlocked: Public presence secured!</p> </li> </ul>"},{"location":"01-Hardware/#17-power-management-solutions","title":"1.7 Power Management Solutions","text":"<p>Power management protects your homelab equipment and ensures uptime. This lab reviews power strip, surge protector, and UPS options.</p>"},{"location":"01-Hardware/#power-management-options","title":"Power Management Options","text":"<ul> <li>Power Strip: Multiple outlets, no surge or outage protection.</li> <li>Surge Protector: Protects against voltage spikes, no backup power.</li> <li>Uninterruptible Power Supply (UPS): Battery backup and surge protection.</li> <li>Smart PDU: Network-manageable power distribution with per-outlet control.</li> </ul>"},{"location":"01-Hardware/#ups-sizing-and-buying-guides","title":"UPS Sizing and Buying Guides","text":"<ul> <li>How to Size a UPS</li> <li>Choosing the Right UPS</li> <li>UPS Buying Guide - Tom's Hardware</li> </ul>"},{"location":"01-Hardware/#validation_6","title":"Validation","text":"<ul> <li> I have selected appropriate power protection for my homelab.</li> <li> I understand the benefits of UPS units for uptime and data protection.</li> <li> I have budgeted for power management solutions. <p>\ud83c\udfc6 Achievement Unlocked: Power shield activated!</p> </li> </ul>"},{"location":"01-Hardware/#exit-criteria","title":"Exit Criteria","text":"<ul> <li> I have identified or acquired a workstation that meets minimum requirements.</li> <li> I have selected or planned Proxmox Nodes with adequate compute, memory, storage, and networking.</li> <li> I have chosen NAS/Storage hardware appropriate for reliability, redundancy, and performance needs.</li> <li> I have planned networking hardware and VLAN segmentation.</li> <li> I understand domain name and SSL certificate requirements.</li> <li> I have verified public IP or dynamic DNS setup.</li> <li> I have selected power management solutions (UPS, surge, or smart PDU) for equipment protection.</li> </ul> <p>\ud83c\udf89 Chapter Complete! You\u2019ve earned up to 70 XP (like Whose Line, the points are made up but the fun is real). Onward to the next adventure!</p> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"02-Workstation-Setup/","title":"Workstation Setup","text":"<p>Quick Overview</p> <p>What: Install the essential workstation tools for building and managing your homelab. Why: These tools are your toolbox\u2014Git, Docker, Terraform, and more. Time: 30\u201390 minutes depending on installs. XP: Up to 70 points (like Whose Line, the points are made up but the fun is real).</p>"},{"location":"02-Workstation-Setup/#entry-checks","title":"Entry Checks","text":"<ul> <li>macOS or Windows with admin rights</li> <li>Git and GitHub account</li> <li>Docker Desktop available</li> </ul>"},{"location":"02-Workstation-Setup/#outcomes","title":"Outcomes","text":"<ul> <li>Install and configure Git and GitHub CLI</li> <li>Install Wrangler and validate Cloudflare login</li> <li>Install Docker Desktop and verify installation</li> <li>Install Terraform and validate setup</li> <li>(Optional) Install Ansible and validate setup on supported platforms</li> </ul> <p>With your hardware ready, it\u2019s time to prepare your workstation. These tools are the core kit that will let you manage, automate, and interact with every part of your homelab journey.</p>"},{"location":"02-Workstation-Setup/#preparing-package-managers","title":"Preparing Package Managers","text":"macOSWindows <ol> <li> <p>Install Homebrew (macOS package manager) (if not already installed):</p> <pre><code>/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"\n</code></pre> </li> </ol> <ol> <li> <p>Install Chocolatey (Windows package manager) (if not already installed):</p> <pre><code>Set-ExecutionPolicy Bypass -Scope Process -Force; `\n[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; `\niex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))\n</code></pre> </li> <li> <p>Install curl (if not already available):</p> <pre><code>choco install curl\n</code></pre> </li> <li> <p>Validate:</p> <pre><code>curl --version\n</code></pre> </li> </ol>"},{"location":"02-Workstation-Setup/#labs","title":"Labs","text":""},{"location":"02-Workstation-Setup/#21-git-and-github-cli","title":"2.1 Git and GitHub CLI","text":"<p>Git and GitHub CLI</p> <p>Git is a distributed version control system. GitHub CLI brings GitHub actions to your terminal. These are essential for managing infrastructure code and collaborating on the homelab.</p> <ul> <li>Official site</li> <li>GitHub CLI docs</li> <li>Getting started with Git</li> <li>GitHub CLI manual</li> </ul> <ol> <li>Create a GitHub account at github.com if you don't already have one.</li> </ol> macOSWindows <ol> <li> <p>Install Git and GitHub CLI:</p> <pre><code>brew install git gh\n</code></pre> </li> <li> <p>Authenticate GitHub CLI:</p> <pre><code>gh auth login\n</code></pre> </li> </ol> <ol> <li> <p>Install Git and GitHub CLI:</p> <pre><code>choco install git gh\n</code></pre> </li> <li> <p>Authenticate GitHub CLI:</p> <pre><code>gh auth login\n</code></pre> </li> </ol>"},{"location":"02-Workstation-Setup/#validation","title":"Validation","text":"<ul> <li> Run <code>git --version</code> to verify Git is installed.</li> <li> Run <code>gh auth status</code> to confirm GitHub CLI is authenticated.</li> </ul> <p>\ud83c\udfc6 Achievement Unlocked: GitHub connected!</p>"},{"location":"02-Workstation-Setup/#22-cloudflare-wrangler","title":"2.2 Cloudflare Wrangler","text":"<p>Cloudflare Wrangler</p> <p>Wrangler is the CLI (Command Line Interface) tool for managing Cloudflare services, including Workers and DNS.</p> <ul> <li>Official site</li> <li>Docs</li> </ul> macOSWindows <ol> <li> <p>Install Node.js (if not already installed):</p> <pre><code>brew install node\n</code></pre> </li> <li> <p>Install Wrangler via npm:</p> <pre><code>npm install -g wrangler\n</code></pre> </li> <li> <p>Authenticate Wrangler:</p> <pre><code>wrangler login\n</code></pre> </li> </ol> <ol> <li> <p>Install Node.js (if not already installed):</p> <pre><code>choco install nodejs\n</code></pre> </li> <li> <p>Install Wrangler via npm:</p> <pre><code>npm install -g wrangler\n</code></pre> </li> <li> <p>Authenticate Wrangler:</p> <pre><code>wrangler login\n</code></pre> </li> </ol>"},{"location":"02-Workstation-Setup/#validation_1","title":"Validation","text":"<ul> <li> Run <code>wrangler --version</code> to verify installation.</li> <li> Run <code>wrangler whoami</code> to confirm authentication.</li> </ul> <p>\ud83c\udfc6 Achievement Unlocked: Cloudflare wrangler ready!</p>"},{"location":"02-Workstation-Setup/#23-docker-desktop","title":"2.3 Docker Desktop","text":"<p>Docker Desktop</p> <p>Docker runs applications in containers. Docker Desktop provides the local engine and UX (User Experience) we will use to run services during the labs.</p> <ul> <li>Official site</li> <li>Docs</li> <li>Training</li> </ul> macOSWindows <ol> <li> <p>Install via Homebrew Cask:</p> <pre><code>brew install --cask docker\n</code></pre> </li> <li> <p>Validate:</p> <pre><code>docker version\ndocker run hello-world\n</code></pre> </li> </ol> <p>Note: Do not install the separate <code>docker</code> formula. Docker Desktop includes the CLI.</p> <ol> <li> <p>Install Docker Desktop. Enable Kubernetes only if needed later.</p> <pre><code>choco install docker-desktop\n</code></pre> </li> </ol> <p>Note: Do not install the separate <code>docker</code> package. Docker Desktop includes the CLI.</p> <ol> <li> <p>Validate:</p> <pre><code>docker version\ndocker run hello-world\n</code></pre> </li> </ol>"},{"location":"02-Workstation-Setup/#validation_2","title":"Validation","text":"<ul> <li> Run <code>docker version</code> to check Docker installation.</li> <li> Run <code>docker run hello-world</code> to verify container runtime.</li> </ul> <p>\ud83c\udfc6 Achievement Unlocked: Docker containerized!</p>"},{"location":"02-Workstation-Setup/#24-terraform-install-and-validation","title":"2.4 Terraform Install and Validation","text":"<p>Terraform</p> <p>Terraform defines infrastructure as code (IaC) and provisions cloud or on\u2011prem resources declaratively.</p> <ul> <li>Official site</li> <li>Docs</li> <li>Getting started</li> </ul> macOSWindows <ol> <li> <p>Install Terraform:</p> <pre><code>brew tap hashicorp/tap\nbrew install hashicorp/tap/terraform\n</code></pre> </li> <li> <p>Validate:</p> <pre><code>terraform -version\n</code></pre> </li> </ol> <ol> <li> <p>Install Terraform:</p> <pre><code>choco install terraform\n</code></pre> </li> <li> <p>Validate:</p> <pre><code>terraform -version\n</code></pre> </li> </ol>"},{"location":"02-Workstation-Setup/#validation_3","title":"Validation","text":"<ul> <li> Run <code>terraform -version</code> to confirm installation.</li> </ul> <p>\ud83c\udfc6 Achievement Unlocked: Terraform deployed!</p>"},{"location":"02-Workstation-Setup/#25-vault-and-consul-cli","title":"2.5 Vault and Consul CLI","text":"<p>HashiCorp Vault and Consul</p> <p>Vault manages secrets and protects sensitive data. Consul provides service discovery and key\u2011value storage. Both CLIs (Command Line Interfaces) are needed for later chapters.</p> <ul> <li>Vault site</li> <li>Consul site</li> <li>Vault CLI docs</li> <li>Consul CLI docs</li> </ul> macOSWindows <ol> <li> <p>Install Vault and Consul:</p> <pre><code>brew tap hashicorp/tap\nbrew install hashicorp/tap/vault hashicorp/tap/consul\n</code></pre> </li> <li> <p>Validate:</p> <pre><code>vault --version\nconsul --version\n</code></pre> </li> </ol> <ol> <li> <p>Install Vault and Consul:</p> <pre><code>choco install vault consul\n</code></pre> </li> <li> <p>Validate:</p> <pre><code>vault --version\nconsul --version\n</code></pre> </li> </ol>"},{"location":"02-Workstation-Setup/#validation_4","title":"Validation","text":"<ul> <li> Run <code>vault --version</code> to verify Vault CLI.</li> <li> Run <code>consul --version</code> to verify Consul CLI.</li> </ul> <p>\ud83c\udfc6 Achievement Unlocked: Secrets and service mesh mastered!</p>"},{"location":"02-Workstation-Setup/#26-ansible-install-and-validation-optional-for-windows","title":"2.6 Ansible Install and Validation (optional for Windows)","text":"<p>Ansible</p> <p>Ansible automates configuration management and orchestration for your homelab.</p> <ul> <li>Official site</li> <li>Docs</li> <li>Getting started</li> </ul> macOSWindows <ol> <li> <p>Install Ansible:</p> <pre><code>brew install ansible\n</code></pre> </li> <li> <p>Validate:</p> <pre><code>ansible --version\n</code></pre> </li> </ol> <p>Optional on Windows</p> <p>On Windows, install Ansible via WSL (Windows Subsystem for Linux) or another supported method. Skip if not needed now.</p> <ol> <li> <p>Validate (if installed):</p> <pre><code>ansible --version\n</code></pre> </li> </ol>"},{"location":"02-Workstation-Setup/#validation_5","title":"Validation","text":"<ul> <li> Run <code>ansible --version</code> to verify installation (if installed).</li> </ul> <p>\ud83c\udfc6 Achievement Unlocked: Automation activated!</p>"},{"location":"02-Workstation-Setup/#27-visual-studio-code","title":"2.7 Visual Studio Code","text":"<p>Visual Studio Code (VS Code)</p> <p>Visual Studio Code (VS Code) is a flexible editor with rich extensions useful for this lab.</p> <ul> <li>Download</li> </ul> macOSWindows <ol> <li> <p>Install Visual Studio Code via Homebrew Cask:</p> <pre><code>brew install --cask visual-studio-code\n</code></pre> </li> <li> <p>Install recommended extensions:</p> <ul> <li>hashicorp.terraform</li> <li>redhat.ansible</li> <li>ms-azuretools.vscode-docker</li> <li>redhat.vscode-yaml</li> <li>github.vscode-github-actions</li> <li>ms-vscode-remote.remote-containers</li> <li>gruntfuggly.todo-tree</li> <li>esbenp.prettier-vscode</li> <li>yzhang.markdown-all-in-one</li> </ul> <pre><code>code --install-extension hashicorp.terraform\ncode --install-extension redhat.ansible\ncode --install-extension ms-azuretools.vscode-docker\ncode --install-extension redhat.vscode-yaml\ncode --install-extension github.vscode-github-actions\ncode --install-extension ms-vscode-remote.remote-containers\ncode --install-extension gruntfuggly.todo-tree\ncode --install-extension esbenp.prettier-vscode\ncode --install-extension yzhang.markdown-all-in-one\n</code></pre> </li> <li> <p>(Optional) Apply quality\u2011of\u2011life settings via CLI by overwriting settings.json:</p> <pre><code>cat &lt;&lt;'EOF' &gt; ~/Library/Application\\ Support/Code/User/settings.json\n{\n  \"editor.formatOnSave\": true,\n  \"files.trimTrailingWhitespace\": true,\n  \"editor.rulers\": [100],\n  \"editor.tabSize\": 2,\n  \"editor.insertSpaces\": true,\n  \"editor.detectIndentation\": false,\n  \"files.autoSave\": \"afterDelay\",\n  \"files.autoSaveDelay\": 1000,\n  \"[terraform]\": { \"editor.defaultFormatter\": \"hashicorp.terraform\" },\n  \"terraform.languageServer\": { \"enabled\": true },\n  \"makefile.configureOnOpen\": true\n}\nEOF\n</code></pre> </li> </ol> <ol> <li> <p>Install Visual Studio Code via Chocolatey:</p> <pre><code>choco install vscode\n</code></pre> </li> <li> <p>Install recommended extensions:</p> <ul> <li>hashicorp.terraform</li> <li>redhat.ansible</li> <li>ms-azuretools.vscode-docker</li> <li>redhat.vscode-yaml</li> <li>github.vscode-github-actions</li> <li>ms-vscode-remote.remote-containers</li> <li>ms-vscode.powershell</li> <li>gruntfuggly.todo-tree</li> <li>esbenp.prettier-vscode</li> <li>yzhang.markdown-all-in-one</li> </ul> <pre><code>code --install-extension hashicorp.terraform\ncode --install-extension redhat.ansible\ncode --install-extension ms-azuretools.vscode-docker\ncode --install-extension redhat.vscode-yaml\ncode --install-extension github.vscode-github-actions\ncode --install-extension ms-vscode-remote.remote-containers\ncode --install-extension ms-vscode.powershell\ncode --install-extension gruntfuggly.todo-tree\ncode --install-extension esbenp.prettier-vscode\ncode --install-extension yzhang.markdown-all-in-one\n</code></pre> </li> <li> <p>(Optional) Apply quality\u2011of\u2011life settings via CLI by overwriting settings.json:</p> <pre><code>Set-Content \"$env:APPDATA\\Code\\User\\settings.json\" @'\n{\n  \"editor.formatOnSave\": true,\n  \"files.trimTrailingWhitespace\": true,\n  \"editor.rulers\": [100],\n  \"editor.tabSize\": 2,\n  \"editor.insertSpaces\": true,\n  \"editor.detectIndentation\": false,\n  \"files.autoSave\": \"afterDelay\",\n  \"files.autoSaveDelay\": 1000,\n  \"[terraform]\": { \"editor.defaultFormatter\": \"hashicorp.terraform\" },\n  \"terraform.languageServer\": { \"enabled\": true },\n  \"makefile.configureOnOpen\": true\n}\n'@\n</code></pre> </li> </ol>"},{"location":"02-Workstation-Setup/#validation_6","title":"Validation","text":"<ul> <li> Open VS Code and verify recommended extensions are installed.</li> </ul> <p>\ud83c\udfc6 Achievement Unlocked: Code editor powered up!</p>"},{"location":"02-Workstation-Setup/#exit-criteria","title":"Exit Criteria","text":"<ul> <li> Git and GitHub CLI are installed and authenticated</li> <li> Wrangler is installed and authenticated</li> <li> curl is installed and validated (Windows only, macOS already includes curl)</li> <li> Docker Desktop is installed and running containers successfully</li> <li> Terraform is installed and validated</li> <li> Ansible is installed and validated (if applicable)</li> <li> Vault CLI is installed and validated</li> <li> Consul CLI is installed and validated</li> </ul> <p>\ud83c\udf89 Chapter Complete! You\u2019ve earned up to 70 XP (like Whose Line, the points are made up but the fun is real). Onward to the next adventure!</p> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"03-Cloud-Accounts-and-Foundations/","title":"Cloud Accounts &amp; Foundations","text":"<p>Quick Overview</p> <p>What: Set up and authenticate core cloud accounts and CLIs. Why: These accounts connect your homelab to the outside world and enable automation. Time: 30\u201360 minutes. XP: Up to 50 points (like Whose Line, the points are made up but the fun is real).</p>"},{"location":"03-Cloud-Accounts-and-Foundations/#entry-checks","title":"Entry Checks","text":"<ul> <li>Workstation setup complete with required CLIs (Command Line Interfaces) installed (gh, wrangler, docker, terraform, vault, consul)</li> <li>HCP (HashiCorp Cloud Platform) Terraform account created and accessible</li> </ul>"},{"location":"03-Cloud-Accounts-and-Foundations/#outcomes","title":"Outcomes","text":"<ul> <li>GitHub account and CLI (Command Line Interface) authenticated</li> <li>Cloudflare account and Wrangler authenticated</li> <li>Docker Hub account and CLI (Command Line Interface) authenticated</li> <li>Optional: HashiCorp Cloud tools (Vault, Consul, Terraform)</li> <li>HCP Terraform workspace created for remote state storage</li> </ul> <p>With your workstation tools installed, it\u2019s time to connect to the cloud. These accounts and CLIs are your lifeline to DNS, source control, container images, and Terraform state management.</p>"},{"location":"03-Cloud-Accounts-and-Foundations/#cloud-accounts","title":"\ud83c\udf10 Cloud Accounts","text":"<p>Before continuing, ensure you have the following accounts created:</p> <ul> <li>GitHub (for source control &amp; CI/CD)</li> <li>Cloudflare (for DNS &amp; security)</li> <li>Docker Hub (for container images)</li> <li>HashiCorp Cloud (for Vault/Consul/Terraform Cloud if desired)</li> </ul>"},{"location":"03-Cloud-Accounts-and-Foundations/#labs","title":"Labs","text":""},{"location":"03-Cloud-Accounts-and-Foundations/#31-github-cli","title":"3.1 GitHub CLI","text":"<p>The GitHub CLI (Command Line Interface) (<code>gh</code>) helps you manage GitHub repositories, pull requests, and authentication from your terminal. - Official docs: GitHub CLI Documentation</p> <p>Authenticate with GitHub using:</p> <pre><code>gh auth login\n</code></pre>"},{"location":"03-Cloud-Accounts-and-Foundations/#validation","title":"Validation","text":"<ul> <li> Run <code>gh --version</code></li> <li> Run <code>gh auth status</code></li> </ul> <p>\ud83c\udfc6 Achievement Unlocked: GitHub authenticated!</p>"},{"location":"03-Cloud-Accounts-and-Foundations/#32-cloudflare-cli-wrangler","title":"3.2 Cloudflare CLI (Wrangler)","text":"<p>Wrangler is Cloudflare\u2019s CLI (Command Line Interface) for managing DNS, Workers, and KV namespaces. - Official docs: Wrangler Documentation</p> <p>Authenticate with Cloudflare using:</p> <pre><code>wrangler login\n</code></pre>"},{"location":"03-Cloud-Accounts-and-Foundations/#validation_1","title":"Validation","text":"<ul> <li> Run <code>wrangler --version</code></li> <li> Run <code>wrangler whoami</code></li> </ul> <p>\ud83c\udfc6 Achievement Unlocked: Cloudflare connected!</p>"},{"location":"03-Cloud-Accounts-and-Foundations/#33-docker-cli","title":"3.3 Docker CLI","text":"<p>The Docker CLI (Command Line Interface) is used to manage containers and also serves as the interface for Docker Hub logins. - Official docs: Docker CLI Docs</p> <p>Authenticate with Docker Hub using:</p> <pre><code>docker login\n</code></pre>"},{"location":"03-Cloud-Accounts-and-Foundations/#validation_2","title":"Validation","text":"<ul> <li> Run <code>docker --version</code></li> <li> Run <code>docker info</code></li> </ul> <p>\ud83c\udfc6 Achievement Unlocked: Docker docked!</p>"},{"location":"03-Cloud-Accounts-and-Foundations/#34-hashicorp-cli-tools","title":"3.4 HashiCorp CLI Tools","text":"<p>These CLI (Command Line Interface) tools are optional but recommended if you plan to use Vault, Consul, or Terraform Cloud. - Terraform CLI - Vault CLI - Consul CLI</p>"},{"location":"03-Cloud-Accounts-and-Foundations/#validation_3","title":"Validation","text":"<ul> <li> Run <code>terraform version</code></li> <li> Run <code>vault status</code></li> <li> Run <code>consul version</code></li> </ul> <p>\ud83c\udfc6 Achievement Unlocked: HashiCorp toolkit ready!</p>"},{"location":"03-Cloud-Accounts-and-Foundations/#35-hcp-terraform-remote-state","title":"3.5 HCP Terraform Remote State","text":"<p>HCP Terraform provides a secure and centralized place to store Terraform state files.</p> <ul> <li> <p>Official docs: HCP Terraform</p> </li> <li> <p>Log in to HCP Terraform:</p> <pre><code>terraform login\n</code></pre> <p>Follow the prompts to generate and paste an API (Application Programming Interface) token.</p> </li> <li> <p>Create a new workspace in your HCP Terraform organization (via web UI or CLI).</p> </li> <li> <p>Update your Terraform configuration to use the remote backend. Example:</p> <pre><code>terraform {\n  backend \"remote\" {\n    organization = \"your-org-name\"\n\n    workspaces {\n      name = \"homelab-infra\"\n    }\n  }\n}\n</code></pre> </li> <li> <p>Initialize the backend:</p> <pre><code>terraform init\n</code></pre> </li> </ul> <p>This ensures your Terraform state is safely stored in HCP Terraform.</p>"},{"location":"03-Cloud-Accounts-and-Foundations/#validation_4","title":"Validation","text":"<ul> <li> Run <code>terraform state list</code></li> </ul> <p>\ud83c\udfc6 Achievement Unlocked: Remote state secured!</p>"},{"location":"03-Cloud-Accounts-and-Foundations/#exit-criteria","title":"Exit Criteria","text":"<ul> <li> GitHub CLI authenticated</li> <li> Cloudflare Wrangler authenticated</li> <li> Docker CLI authenticated</li> <li> (Optional) HashiCorp tools validated</li> <li> HCP Terraform remote state configured and validated</li> </ul> <p>\ud83c\udf89 Chapter Complete! You\u2019ve earned up to 50 XP (like Whose Line, the points are made up but the fun is real). Your cloud foundations are live!</p> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"04-Network-Setup/","title":"Network Setup &amp; Terraform Imports","text":"<p>Quick Overview</p> <p>What: Build VLANs, firewall rules, and WiFi networks. Why: Networking is the backbone; it secures and connects everything. Time: 60\u2013120 minutes. XP: Up to 80 points (like Whose Line, the points are made up but the fun is real).</p>"},{"location":"04-Network-Setup/#entry-checks","title":"Entry Checks","text":"<ul> <li>Router/firewall reachable via UI and SSH.</li> <li>Admin creds and backup exported.</li> <li>Terraform CLI (Command Line Interface) installed and working.</li> </ul>"},{"location":"04-Network-Setup/#outcomes","title":"Outcomes","text":"<ul> <li>VLANs and CIDRs (Classless Inter-Domain Routing ranges) documented and provisioned.</li> <li>Router/firewall interfaces and DHCP scopes configured.</li> <li>Terraform state updated via <code>terraform import</code> for existing network objects.</li> </ul> <p>This chapter turns your design into reality. With VLANs, tagging, firewall rules, and WiFi, you\u2019ll wire your homelab\u2019s nervous system.</p>"},{"location":"04-Network-Setup/#labs","title":"Labs","text":""},{"location":"04-Network-Setup/#41-design-the-addressing-plan","title":"4.1 Design the addressing plan","text":"<ul> <li>Choose RFC1918 blocks and per\u2011VLAN CIDRs.</li> <li>Reserve infra ranges for gateways, DHCP (Dynamic Host Configuration Protocol), DNS (Domain Name System), and static hosts.</li> </ul>"},{"location":"04-Network-Setup/#vlan-matrix-template","title":"VLAN Matrix Template","text":"<p>Fill out this matrix to document each VLAN with addressing and usage details.</p> VLAN Name VLAN ID Subnet Gateway DHCP Range Reserved Range Purpose Default 1 172.16.0.0/24 172.16.0.1 172.16.0.30 \u2013 172.16.0.254 172.16.0.2 \u2013 172.16.0.29 Bootstrap, UniFi infra, temporary devices Family 5 172.16.5.0/24 172.16.5.1 172.16.5.30 \u2013 172.16.5.254 172.16.5.2 \u2013 172.16.5.5 Household user devices Production 10 172.16.10.0/24 172.16.10.1 172.16.10.30 \u2013 172.16.10.254 172.16.10.2 \u2013 172.16.10.5 Stable services and servers Cluster 12 172.16.12.0/24 172.16.12.1 172.16.12.30 \u2013 172.16.12.254 172.16.12.2 \u2013 172.16.12.9 Hypervisors, K8s control plane Mgmt-Admin 15 172.16.15.0/24 172.16.15.1 172.16.15.30 \u2013 172.16.15.254 172.16.15.2 \u2013 172.16.15.5 Admin workstations, jump hosts, management UIs (Proxmox, NAS (Network Attached Storage), etc.) Lab 20 172.16.20.0/24 172.16.20.1 172.16.20.30 \u2013 172.16.20.254 172.16.20.2 \u2013 172.16.20.5 Experiments and short\u2011lived workloads Storage 30 172.16.30.0/24 172.16.30.1 172.16.30.30 \u2013 172.16.30.254 172.16.30.2 \u2013 172.16.30.5 NAS, backup targets, storage services DMZ 40 172.16.40.0/24 172.16.40.1 172.16.40.30 \u2013 172.16.40.254 172.16.40.2 \u2013 172.16.40.5 Public\u2011facing services (Demilitarized Zone) Parking 99 172.16.99.0/24 172.16.99.1 \u2014 172.16.99.2 \u2013 172.16.99.254 Disabled/sinkhole ports with no DHCP Guest 101 172.16.101.0/24 172.16.101.1 172.16.101.30 \u2013 172.16.101.254 172.16.101.2 \u2013 172.16.101.5 Guest WiFi and public wired ports with internet-only access IoT 200 172.16.200.0/23 172.16.200.1 172.16.200.30 \u2013 172.16.201.254 172.16.200.2 \u2013 172.16.200.29 Smart home and camera devices (former VLAN 201 merged) (Internet of Things)"},{"location":"04-Network-Setup/#validation","title":"Validation","text":"<ul> <li> VLANs documented in matrix \ud83c\udfc6 Achievement Unlocked: Network blueprint drafted!</li> </ul>"},{"location":"04-Network-Setup/#42-define-vlans-and-tagging","title":"4.2 Define VLANs and tagging","text":"<ul> <li>Map names \u2192 IDs (e.g., <code>10-MGMT</code>, <code>20-SERVERS</code>, <code>30-IOT</code>, <code>40-GUEST</code>).</li> <li>Document trunk and access ports on the switch.</li> </ul>"},{"location":"04-Network-Setup/#switch-port-mapping","title":"Switch Port Mapping","text":"<p>Define access vs trunk ports to ensure consistent VLAN assignments across switches.</p> Port Mode VLAN(s) Usage Port 1 Trunk All Uplink to router Port 2 Access 15 Mgmt-Admin workstation Port 3 Access 30 NAS/Storage Port 4 Access 200 IoT device Port 5 Access 101 Guest wired drop Port 6-24 Trunk All APs (Access Points) / downstream switches <p>Adjust per physical layout. Document every port to avoid misconfiguration and to simplify Terraform imports.</p>"},{"location":"04-Network-Setup/#validation_1","title":"Validation","text":"<ul> <li> Switch ports mapped and documented \ud83c\udfc6 Achievement Unlocked: Ports aligned!</li> </ul>"},{"location":"04-Network-Setup/#43-configure-routerfirewall","title":"4.3 Configure router/firewall","text":"<ul> <li>Create VLAN interfaces and gateways.</li> <li>Enable DHCP per VLAN and set DNS (DNS at this stage is UniFi only; other DNS services are integrated later).</li> <li>Add basic inter\u2011VLAN rules and block guest\u2192LAN.</li> </ul>"},{"location":"04-Network-Setup/#validation_2","title":"Validation","text":"<ul> <li> VLAN interfaces created</li> <li> DHCP enabled per VLAN</li> <li> Basic rules applied \ud83c\udfc6 Achievement Unlocked: Firewall foundations laid!</li> </ul>"},{"location":"04-Network-Setup/#43b-configure-ntp","title":"4.3b Configure NTP","text":"<ul> <li>Ensure all network gear, Proxmox nodes, and NAS devices sync to consistent time sources.</li> <li>UniFi requires IP addresses, not hostnames, for NTP servers.</li> </ul>"},{"location":"04-Network-Setup/#recommended-servers","title":"Recommended Servers","text":"<ul> <li>Primary: <code>132.163.96.1</code> (NIST Boulder)</li> <li>Secondary: <code>129.6.15.28</code> (NIST Gaithersburg)</li> <li>LAN fallback: NAS01 at <code>172.16.0.5</code> with NTP service enabled</li> </ul>"},{"location":"04-Network-Setup/#steps","title":"Steps","text":"<ol> <li>In UniFi Controller, go to Settings \u2192 System \u2192 Advanced \u2192 NTP Servers.</li> <li>Enter both NIST IPs.</li> <li>Enable NTP service on NAS01 (DSM: Control Panel \u2192 Regional Options \u2192 Time \u2192 NTP Service).</li> <li>Configure Proxmox nodes to use all three sources:</li> <li><code>132.163.96.1</code> (UniFi/DHCP-limited NTP server)</li> <li><code>129.6.15.28</code> (UniFi/DHCP-limited NTP server)</li> <li><code>172.16.0.5</code> (NAS01; must be added manually on Proxmox nodes since UniFi only supports 2 servers)</li> <li>Validate with <code>timedatectl show-timesync --all</code> on Proxmox that all sources are listed and in sync.</li> </ol>"},{"location":"04-Network-Setup/#validation_3","title":"Validation","text":"<ul> <li> UniFi NTP servers configured with both NIST IPs</li> <li> NAS01 NTP service enabled</li> <li> Proxmox nodes use both NIST IPs from UniFi and NAS01 (manual fallback) as time sources \ud83c\udfc6 Achievement Unlocked: Network time synchronized!</li> </ul>"},{"location":"04-Network-Setup/#44-export-and-import-to-terraform","title":"4.4 Export and import to Terraform","text":"<ul> <li>Initialize provider for your platform.</li> <li>Use <code>terraform import</code> to capture existing VLANs, interfaces, DHCP, and rules.</li> <li>Include UniFi group imports as well.</li> <li>Run <code>terraform plan</code> to verify drift is zero.</li> </ul>"},{"location":"04-Network-Setup/#terraform-import-matrix","title":"Terraform Import Matrix","text":"<p>Map UniFi objects to Terraform resources for reproducible state.</p> Object Example ID Terraform Resource VLAN vlan_200 unifi_network SSID ssid_iot_modern unifi_wireless_network Firewall Rule rule_guest_to_lan_block unifi_firewall_rule Group group_admins unifi_user_group"},{"location":"04-Network-Setup/#validation_4","title":"Validation","text":"<ul> <li> Terraform imports succeed</li> <li> terraform plan shows no drift \ud83c\udfc6 Achievement Unlocked: State captured!</li> </ul>"},{"location":"04-Network-Setup/#45-configure-wifi-networks","title":"4.5 Configure WiFi Networks","text":"<ul> <li>Create SSIDs (Service Set Identifiers) mapped to VLANs (Home/Family, Guest, IoT\u2011Legacy, IoT\u2011Modern).</li> <li>Apply security settings.</li> <li>Assign VLAN IDs.</li> <li>Verify WiFi clients get correct IPs.</li> </ul>"},{"location":"04-Network-Setup/#target-ssids-and-vlan-mappings-end-state","title":"Target SSIDs and VLAN mappings (end state)","text":"SSID VLAN Bands Security Client Isolation Notes Home Family (5) 2.4 + 5 GHz WPA2/WPA3 Transition Off Primary household devices Guest Guest (101) 2.4 + 5 GHz WPA2/WPA3 Transition On Internet-only, no LAN access IoT\u2011Legacy IoT (200) /23 2.4 GHz WPA2\u2011PSK On Legacy smart home and cameras; widest compatibility IoT\u2011Modern IoT (200) /23 5 GHz WPA3 or WPA3\u2011Transition On Newer IoT; easier to identify devices worth upgrading <p>Note: - UniFi SSID count kept minimal to meet per-AP limits and reduce airtime beacons. - Legacy or migrating devices can temporarily use a hidden SSID mapped to VLAN 200; remove when stable. - Use distinct PSKs for Legacy vs Modern to simplify device audits and planned upgrades.</p>"},{"location":"04-Network-Setup/#notes-on-unifi-ssid-limits-and-design","title":"Notes on UniFi SSID limits and design","text":"<p>Keep SSID count minimal to meet per-AP limits and reduce beacon airtime. Use two IoT SSIDs split by band on the single IoT VLAN (200 /23) to maximize compatibility while avoiding extra VLANs.</p>"},{"location":"04-Network-Setup/#best-practices","title":"Best Practices","text":"<ul> <li>Use 2.4 GHz band for IoT and Camera devices due to better range and compatibility.</li> <li>Use dual-band (2.4 GHz and 5 GHz) SSIDs for Family and Guest networks to optimize performance and device connectivity.</li> <li>Place management SSIDs and VLAN 15 on 5 GHz only, reduce 2.4 GHz exposure.</li> <li>Periodically audit DHCP leases and static assignments to avoid scope exhaustion.</li> </ul>"},{"location":"04-Network-Setup/#firewall-rules-desired-state","title":"Firewall Rules (Desired State)","text":"<ul> <li>Block Guest (101) to LAN (all other VLANs) except Internet.</li> <li>Block IoT-Legacy/Modern (200) to LAN except allowed destinations (NVR, Home Assistant, etc.).</li> <li>Allow Mgmt-Admin (15) full access to all VLANs.</li> <li>Restrict DMZ (40) to Internet inbound/outbound only; no lateral movement.</li> <li>Log and alert on denied inter-VLAN traffic.</li> </ul>"},{"location":"04-Network-Setup/#moving-a-client-between-vlans-in-unifi-ui-for-testing","title":"Moving a client between VLANs in UniFi UI for testing","text":"<ol> <li>Log in to the UniFi Controller UI.</li> <li>Navigate to the Devices section and select the client device.</li> <li>Under the client\u2019s settings, locate the network or VLAN assignment.</li> <li>Change the VLAN or network group to the desired VLAN for testing.</li> <li>Apply changes and verify the client obtains an IP address in the new VLAN and has appropriate network access.</li> </ol>"},{"location":"04-Network-Setup/#validation_5","title":"Validation","text":"<ul> <li> SSIDs created</li> <li> Devices receive correct VLAN IPs</li> <li> Isolation verified \ud83c\udfc6 Achievement Unlocked: WiFi worlds connected!</li> </ul>"},{"location":"04-Network-Setup/#exit-criteria","title":"Exit Criteria","text":"<ul> <li> CIDR/VLAN matrix committed to the repo.</li> <li> Router/switch configs backed up.</li> <li> Terraform state contains imported network resources.</li> </ul> <p>\ud83c\udf89 Chapter Complete! You\u2019ve earned up to 80 XP (like Whose Line, the points are made up but the fun is real). Networking backbone established!</p> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"05-NAS-Setup/","title":"NAS Setup","text":"<p>Quick Overview</p> <p>What: Prepare a Synology NAS (and optional UNAS) for homelab use. Why: NAS is the foundation for VM storage, PBS backups, media, and container data. Time: 60\u2013120 minutes. XP: Up to 90 points.</p>"},{"location":"05-NAS-Setup/#entry-checks","title":"Entry Checks","text":"<ul> <li>Synology NAS reachable on the network</li> <li>Admin credentials available</li> <li>Workstation can reach DSM web console</li> </ul>"},{"location":"05-NAS-Setup/#outcomes","title":"Outcomes","text":"<ul> <li>Shares and permissions codified via UI or automation</li> <li>NFS/iSCSI/SMB exports ready for Proxmox, PBS, and other hosts</li> <li>Snapshot policy baseline defined and validated</li> <li>NAS01 NTP service enabled for LAN fallback</li> <li>Optional: lightweight Docker environment enabled for seed services (Portainer, CI/CD tools)</li> </ul> <p>Storage is where your homelab lives. This chapter gets your Synology and UNAS ready for shares, snapshots, and even container workloads.</p>"},{"location":"05-NAS-Setup/#labs","title":"Labs","text":""},{"location":"05-NAS-Setup/#lab-1-detect-import-existing-shares-and-nfs-exports","title":"Lab 1: Detect &amp; import existing shares and NFS exports","text":""},{"location":"05-NAS-Setup/#validation","title":"Validation","text":"<ul> <li> Existing exports detected and mounted \ud83c\udfc6 Achievement Unlocked: Legacy shares imported!</li> </ul>"},{"location":"05-NAS-Setup/#lab-2-create-required-shares-and-luns-grouped-by-nfs-or-iscsi-roles-media-backups-workloads","title":"Lab 2: Create required shares and LUNs grouped by NFS or iSCSI roles (media, backups, workloads).","text":""},{"location":"05-NAS-Setup/#validation_1","title":"Validation","text":"<ul> <li> New shares and LUNs created \ud83c\udfc6 Achievement Unlocked: Storage provisioned!</li> </ul>"},{"location":"05-NAS-Setup/#lab-3-define-and-apply-snapshot-policy","title":"Lab 3: Define and apply snapshot policy","text":""},{"location":"05-NAS-Setup/#validation_2","title":"Validation","text":"<ul> <li> Snapshot policy applied \ud83c\udfc6 Achievement Unlocked: Snapshots secured!</li> </ul>"},{"location":"05-NAS-Setup/#lab-4-setup-portainer-ui-for-managing-containers","title":"Lab 4: Setup Portainer (UI for managing containers)","text":""},{"location":"05-NAS-Setup/#validation_3","title":"Validation","text":"<ul> <li> Portainer accessible \ud83c\udfc6 Achievement Unlocked: Portainer helm on deck!</li> </ul>"},{"location":"05-NAS-Setup/#lab-51-planned-nas-layout-iscsi-nfs-default-shares","title":"Lab 5.1: Planned NAS Layout (iSCSI, NFS, default shares)","text":""},{"location":"05-NAS-Setup/#iscsi-shares","title":"iSCSI Shares","text":"<ul> <li><code>vm-store</code> (Proxmox VM datastore, default)</li> <li><code>pbs-backups</code> (Proxmox Backup Server datastore)</li> <li><code>db-lun</code> (Databases needing block storage, optional)</li> <li><code>docker-lun</code> (Persistent container data, optional)</li> <li><code>k8s-pv</code> (Kubernetes persistent volumes, optional)</li> </ul>"},{"location":"05-NAS-Setup/#nfs-shares","title":"NFS Shares","text":"<ul> <li><code>/Homes</code> (user home directories, Synology default)</li> <li><code>/Photo</code> (Synology Photos service)</li> <li><code>/Download</code> (general downloads, optional)</li> <li><code>/Media</code> (Plex and related media storage, served from NAS02)</li> </ul> <p>NAS01 is primary for VM/backup workloads. NAS02 is reserved for media (NFS only).</p> <p>Default Synology Shares - <code>/home</code> and <code>/homes</code> (keep \u2013 user private directories, family network homes) - <code>/photo</code> (keep \u2013 required for Synology Photos app) - <code>/music</code> (drop \u2013 only used by Audio Station, not needed with Plex) - <code>/video</code> (drop \u2013 only used by Video Station, Plex/UNAS will be used instead) - <code>/surveillance</code> (skip \u2013 only created if Surveillance Station is enabled) - <code>/docker</code> (drop \u2013 only used for Synology Docker, not needed with Portainer/Proxmox)</p>"},{"location":"05-NAS-Setup/#validation_4","title":"Validation","text":"<ul> <li> Layout documented and approved \ud83c\udfc6 Achievement Unlocked: NAS blueprint created!</li> </ul>"},{"location":"05-NAS-Setup/#lab-52-detect-import-existing-shares-and-nfs-exports","title":"Lab 5.2: Detect &amp; import existing shares and NFS exports","text":""},{"location":"05-NAS-Setup/#validation_5","title":"Validation","text":"<ul> <li> Existing exports detected and mounted \ud83c\udfc6 Achievement Unlocked: Legacy shares imported!</li> </ul>"},{"location":"05-NAS-Setup/#lab-53-create-required-shares-and-luns-grouped-by-nfs-or-iscsi-roles-media-backups-workloads","title":"Lab 5.3: Create required shares and LUNs grouped by NFS or iSCSI roles (media, backups, workloads).","text":""},{"location":"05-NAS-Setup/#validation_6","title":"Validation","text":"<ul> <li> New shares and LUNs created \ud83c\udfc6 Achievement Unlocked: Storage provisioned!</li> </ul>"},{"location":"05-NAS-Setup/#lab-54-define-and-apply-snapshot-policy","title":"Lab 5.4: Define and apply snapshot policy","text":""},{"location":"05-NAS-Setup/#validation_7","title":"Validation","text":"<ul> <li> Snapshot policy applied \ud83c\udfc6 Achievement Unlocked: Snapshots secured!</li> </ul>"},{"location":"05-NAS-Setup/#lab-55-setup-portainer-ui-for-managing-containers","title":"Lab 5.5: Setup Portainer (UI for managing containers)","text":""},{"location":"05-NAS-Setup/#validation_8","title":"Validation","text":"<ul> <li> Portainer accessible \ud83c\udfc6 Achievement Unlocked: Portainer helm on deck!</li> </ul>"},{"location":"05-NAS-Setup/#lab-56-deploy-consul-service-discovery-and-configuration-backend-for-vault","title":"Lab 5.6: Deploy Consul (service discovery and configuration, backend for Vault)","text":""},{"location":"05-NAS-Setup/#validation_9","title":"Validation","text":"<ul> <li> Consul running \ud83c\udfc6 Achievement Unlocked: Consul online!</li> </ul>"},{"location":"05-NAS-Setup/#lab-57-deploy-vault-secrets-management","title":"Lab 5.7: Deploy Vault (secrets management)","text":""},{"location":"05-NAS-Setup/#validation_10","title":"Validation","text":"<ul> <li> Vault running \ud83c\udfc6 Achievement Unlocked: Vault sealed and ready!</li> </ul>"},{"location":"05-NAS-Setup/#lab-58-deploy-homepage-landing-page-for-services","title":"Lab 5.8: Deploy Homepage (landing page for services)","text":""},{"location":"05-NAS-Setup/#validation_11","title":"Validation","text":"<ul> <li> Homepage reachable \ud83c\udfc6 Achievement Unlocked: Dashboard launched!</li> </ul>"},{"location":"05-NAS-Setup/#lab-5a-introduction-to-raid-nfs-and-iscsi-explanation-and-why-they-matter-in-homelab-setup","title":"Lab 5.A: Introduction to RAID, NFS, and iSCSI (explanation and why they matter in homelab setup)","text":""},{"location":"05-NAS-Setup/#lab-5b-best-practices-for-setting-up-a-nassynology-covering-user-management-folder-structure-snapshots-and-backups-also-configure-the-nas-to-provide-ntp-service-for-the-lan-control-panel-regional-options-time-ntp-service","title":"Lab 5.B: Best practices for setting up a NAS/Synology (covering user management, folder structure, snapshots, and backups) Also configure the NAS to provide NTP service for the LAN (Control Panel \u2192 Regional Options \u2192 Time \u2192 NTP Service).","text":""},{"location":"05-NAS-Setup/#background-concepts","title":"Background Concepts","text":"<ul> <li>RAID: A method of combining multiple hard drives into a single unit to improve performance and/or provide redundancy to protect data in case of drive failure.</li> <li>NFS (Network File System): A protocol that allows a computer to access files over a network as if they were on local storage, commonly used for sharing files in Unix/Linux environments.</li> <li>iSCSI (Internet Small Computer Systems Interface): A protocol that enables block-level storage over a network, allowing systems to use remote storage devices as if they were locally attached disks.</li> </ul>"},{"location":"05-NAS-Setup/#exit-criteria","title":"Exit Criteria","text":"<ul> <li> Shares and exports are configured and validated</li> <li> Snapshot and replication policies active</li> <li> NAS01 NTP service enabled and validated</li> <li> Optional container workloads deployed (if enabled)</li> <li> UNAS exports validated</li> <li> Docker workloads deployed via Portainer</li> <li> Core workloads (Portainer, Homepage, Vault, Consul, PBS integration) deployed and validated</li> </ul> <p>\ud83c\udf89 Chapter Complete! You\u2019ve earned up to 90 XP. Storage fortress online!</p> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"06-Proxmox-Cluster-Setup/","title":"Proxmox Cluster Setup","text":"<p>Quick Overview</p> <p>What: Prepare and build a 3-node Proxmox cluster with storage and networking. Why: Clustering unlocks High Availability (HA), shared storage, and scaling for your homelab. Time: 90\u2013150 minutes. XP: Up to 100 points (like Whose Line, the points are made up but the fun is real).</p>"},{"location":"06-Proxmox-Cluster-Setup/#outcomes","title":"Outcomes","text":"<ul> <li>Proxmox installed and nodes joined into a cluster</li> <li>Cluster storage configured and accessible</li> <li>Networks segmented (management, storage, workloads)</li> <li>Baseline Virtual Machines (VMs) created for Consul + Vault</li> </ul> <p>Now it\u2019s time to link your nodes into a unified cluster. Proper Network Interface Card (NIC) setup, storage connections, and VM baselines will give you a resilient backbone for your homelab.</p> <p>Before forming the cluster</p> <ul> <li>Put the cluster (ring0) IP first in <code>/etc/hosts</code> for each node's canonical name (e.g., <code>GPU01</code>).</li> <li>Ensure management IP is a separate alias/line (e.g., <code>GPU01-mgmt</code>).</li> <li>Make sure time is in sync across all nodes (see Time Sync below).</li> <li>Verify VLAN reachability for mgmt (15), cluster (12), and storage (30).</li> </ul>"},{"location":"06-Proxmox-Cluster-Setup/#entry-checks","title":"Entry Checks","text":"<ul> <li>Hardware nodes available and reachable on the network</li> <li>Admin workstation can reach Proxmox web User Interface (UI)</li> <li>Virtual Local Area Networks (VLANs) planned and documented</li> <li>HA watchdog playbook ready to run on all nodes</li> </ul>"},{"location":"06-Proxmox-Cluster-Setup/#cluster-decisions-pending","title":"Cluster Decisions Pending","text":"<p>Track and lock decisions that affect automation and later migrations.</p> <ul> <li> <p> Auth model (now \u2192 later): start with <code>root@pam</code> + API tokens; migrate to SSO/LDAP later.   Impact: inventories use pam credentials initially; plan a credential rotation runbook.</p> </li> <li> <p> TLS certificates: start with self-signed on all nodes; migrate to Let's Encrypt (DNS-01) later.   Impact: Terraform/Ansible set <code>validate_certs: false</code> initially; flip to true after cert rollout.</p> </li> <li> <p> Template strategy: standardize template IDs 9000\u20139099 and names like <code>tmpl-ubuntu-24.04.3-amd64</code>.   Impact: Terraform references stable template IDs; CI can rebuild templates safely.</p> </li> <li> <p> PBS retention defaults: daily 7, weekly 4, monthly 6.   Note: Per-VM overrides allowed as services come online.</p> </li> <li> <p> Monitoring stack host: defer until cluster is live.   Plan: Deploy Prometheus + exporters after base cluster and PBS are running.</p> </li> <li> <p> Fencing/HA watchdog: verify watchdog support on GPU01, NUC01, NUC02; enable Proxmox HA stack.   Steps:     1) Check <code>dmesg | grep -i watchdog</code> and <code>lsmod | grep -i watchdog</code>     2) If absent, enable <code>softdog</code> temporarily or vendor-specific module if available     3) Confirm <code>pve-ha-lrm</code> and <code>pve-ha-crm</code> services are active     4) Document final fencing method</p> </li> </ul>"},{"location":"06-Proxmox-Cluster-Setup/#time-sync","title":"Time Sync","text":""},{"location":"06-Proxmox-Cluster-Setup/#time-sync-configuration","title":"Time Sync Configuration","text":"<p>Accurate and consistent time is critical for Proxmox clustering, Corosync quorum, PBS, and logs.</p> <p>Plan: Hybrid NTP setup - Primary: <code>132.163.96.1</code> and <code>129.6.15.28</code> (NIST official servers). - Secondary (LAN fallback): NAS01 at <code>172.16.0.5</code> with NTP Service enabled in DSM (Control Panel \u2192 Regional Options \u2192 Time).</p> <p>Implementation 1. On NAS01, enable the built-in NTP Service. 2. On all Proxmox nodes (GPU01, NUC01, NUC02), configure NTP servers:    - <code>132.163.96.1</code>    - <code>129.6.15.28</code>    - <code>172.16.0.5</code> Note (Proxmox specifics): On Proxmox, you might not see a <code>systemd-timesyncd.service</code> unit even though <code>timedatectl</code> reports NTP as active. Configure servers and check sync via:    <pre><code>timedatectl set-ntp true\ntimedatectl show-timesync --all | sed -n '1,80p'\ntimedatectl status\ndate\n</code></pre>    If you prefer a full NTP daemon, install and configure <code>chrony</code> instead of relying on the minimal timesync stub. 3. Verify with <code>timedatectl show-timesync --all</code> that both sources are listed and sync is stable. 4. PBS VM will inherit this config from its Proxmox host. 5. Optional: monitor NTP drift with Prometheus node_exporter.</p>"},{"location":"06-Proxmox-Cluster-Setup/#validation","title":"Validation","text":"<ul> <li> NTP service enabled on NAS01</li> <li> All cluster nodes use both 132.163.96.1, 129.6.15.28, and NAS01 as time sources \ud83c\udfc6 Achievement Unlocked: Cluster clocks in sync!</li> </ul>"},{"location":"06-Proxmox-Cluster-Setup/#labs","title":"Labs","text":""},{"location":"06-Proxmox-Cluster-Setup/#61-nic-setup-for-single-vs-multiple-network-interface-cards-nics","title":"6.1 NIC Setup for single vs multiple Network Interface Cards (NICs)","text":"<p>Explain benefits and that Network Interface Cards (NICs) should be configured before cluster creation.</p>"},{"location":"06-Proxmox-Cluster-Setup/#validation_1","title":"Validation","text":"<ul> <li> Network Interface Cards (NICs) configured before cluster join \ud83c\udfc6 Achievement Unlocked: Network interfaces ready!</li> </ul>"},{"location":"06-Proxmox-Cluster-Setup/#61b-validate-vlan-reachability","title":"6.1b Validate VLAN reachability","text":"<p>Before forming the cluster, verify that all VLANs are properly configured and reachable from each node.</p>"},{"location":"06-Proxmox-Cluster-Setup/#steps","title":"Steps","text":"<ol> <li>From GPU01, NUC01, and NUC02:    <pre><code>ping 172.16.15.1     # VLAN 15 gateway (Mgmt)\nping 172.16.12.1     # VLAN 12 gateway (Cluster/Corosync, if routed)\nping 172.16.30.5     # NAS01 storage NIC\nping 172.16.30.4     # NAS02 storage NIC\n</code></pre></li> <li>Check routing tables on each node (<code>ip route</code>) to confirm correct gateways.</li> <li>Verify VLAN tagging on switch ports for each server NIC.</li> <li>Adjust Proxmox network config (<code>/etc/network/interfaces</code>) if rebuild resets them.</li> </ol>"},{"location":"06-Proxmox-Cluster-Setup/#validation_2","title":"Validation","text":"<ul> <li> GPU01, NUC01, and NUC02 can reach VLAN 15 (Mgmt)</li> <li> GPU01 can reach VLAN 12 (Cluster) and VLAN 30 (Storage)</li> <li> NUC01 and NUC02 can reach VLAN 30 if required for storage</li> </ul> <p>\ud83c\udfc6 Achievement Unlocked: VLANs alive and reachable!</p>"},{"location":"06-Proxmox-Cluster-Setup/#61c-hostname-etchosts-requirements-critical","title":"6.1c Hostname &amp; <code>/etc/hosts</code> requirements (critical)","text":"<p>Corosync will bind to the address that your node's canonical hostname resolves to. Ensure the cluster IP (VLAN 12) is first for the node's primary name, and keep management/storage on separate aliases.</p> <p>Example <code>/etc/hosts</code> on GPU01 <pre><code>127.0.0.1       localhost\n::1             localhost\n\n# PVE node \u2013 put CLUSTER IP first\n172.16.12.10    GPU01.SpecterRealm.com GPU01 gpu01.local gpu01\n# Mgmt IP as separate alias\n172.16.15.10    GPU01-mgmt.SpecterRealm.com GPU01-mgmt\n# Storage IP as separate alias (optional)\n172.16.30.10    GPU01-stor.SpecterRealm.com GPU01-stor\n</code></pre></p> <p>Validation <pre><code>getent hosts $(hostname -s)     # should return the ring0/cluster IP first\nhostname -I                      # verify the expected addresses exist\n</code></pre></p>"},{"location":"06-Proxmox-Cluster-Setup/#62-create-proxmox-cluster-across-nodea-nodeb-nodec","title":"6.2 Create Proxmox cluster across NodeA, NodeB, NodeC","text":"<p>Note: GPU01 is the primary cluster manager and the first node in the cluster.</p>"},{"location":"06-Proxmox-Cluster-Setup/#understanding-quorum-and-qdevice","title":"Understanding Quorum and QDevice","text":"<p>Quorum is the mechanism that ensures cluster consistency by requiring a majority of nodes to be online and communicating. To improve quorum reliability, a QDevice can be added as a tie-breaker. NAS01 can later serve as a QDevice host if a node is removed or travels, helping maintain cluster availability.</p>"},{"location":"06-Proxmox-Cluster-Setup/#validation_3","title":"Validation","text":"<ul> <li> Cluster created with quorum \ud83c\udfc6 Achievement Unlocked: Cluster formed!</li> </ul>"},{"location":"06-Proxmox-Cluster-Setup/#62a-join-via-cli-fallback-when-api-join-errors-with-csrf","title":"6.2a Join via CLI (fallback when API join errors with CSRF)","text":"<p>If the API-based join fails with <code>Permission denied - invalid csrf token</code>, use the SSH join workflow:</p> <pre><code># On the joining node (e.g., NUC01/NUC02)\npvecm add GPU01.SpecterRealm.com --use_ssh         # or: pvecm add 172.16.12.10 --use_ssh\n# If the node was partially joined before, add --force:\npvecm add 172.16.12.10 --use_ssh --force\n</code></pre> <p>Why this helps: <code>--use_ssh</code> bypasses the token-based API flow that can be impacted by name/TLS/CSRF issues and uses the Proxmox-maintained SSH path to copy the corosync auth key and generate certificates.</p>"},{"location":"06-Proxmox-Cluster-Setup/#62b-removere-add-a-stale-node","title":"6.2b Remove/re-add a stale node","text":"<p>If a node was joined with the wrong IP or failed mid-join, clean it up and rejoin:</p> <pre><code># On the broken node (e.g., NUC02)\nsystemctl stop pve-cluster corosync\nkillall pmxcfs || true\nrm -rf /etc/pve/corosync.conf\nrm -rf /etc/corosync/* /var/lib/corosync/* /var/lib/pve-cluster/config.db*\nsystemctl start pve-cluster\n\n# Re-add via SSH (forces overwrite of stale config)\npvecm add 172.16.12.10 --use_ssh --force\n</code></pre> <p>If the cluster itself lost quorum during cleanup, on the leader you can temporarily lower the expected votes to remove a dead node: <pre><code>pvecm expected 1\npvecm delnode &lt;NODENAME&gt;\n</code></pre></p>"},{"location":"06-Proxmox-Cluster-Setup/#62c-fixing-wrong-ring0-ip-after-cluster-creation","title":"6.2c Fixing wrong ring0 IP after cluster creation","text":"<p>If the leader formed the cluster using the management IP instead of the cluster IP:</p> <p>1) Fix <code>/etc/hosts</code> on the leader so the cluster IP is first for the node\u2019s canonical name (see 6.1c). 2) Recreate the cluster cleanly on the leader: <pre><code>systemctl stop pve-cluster corosync\npmxcfs -l               # ensure it now resolves to the cluster IP\nrm -f /etc/pve/corosync.conf\nkillall pmxcfs || true\nsystemctl start pve-cluster\npvecm create pve-cluster01\n</code></pre> 3) Join the remaining nodes with: <pre><code>pvecm add 172.16.12.10 --use_ssh\n</code></pre> 4) Validate: <pre><code>pvecm status\ngrep -E 'ring0_addr|name|cluster_name' /etc/pve/corosync.conf\n</code></pre></p>"},{"location":"06-Proxmox-Cluster-Setup/#63-configure-management-vlan-and-access-control-lists-acls-allow-jump-box-continuous-integration-ci-admin","title":"6.3 Configure management VLAN and Access Control Lists (ACLs) (allow Jump Box, Continuous Integration (CI), admin)","text":"<p>VLAN IDs: - VLAN 15: Management - VLAN 12: Corosync/Cluster - VLAN 30: Storage - VLAN 10: Production workloads - VLAN 20: Lab - VLAN 40: Public Access - VLAN 5: Family - VLAN 200: IoT</p>"},{"location":"06-Proxmox-Cluster-Setup/#validation_4","title":"Validation","text":"<ul> <li> Management VLAN and Access Control Lists (ACLs) verified \ud83c\udfc6 Achievement Unlocked: Secure management lanes!</li> </ul>"},{"location":"06-Proxmox-Cluster-Setup/#64-connect-to-network-attached-storage-nas-via-network-file-system-nfs-and-internet-small-computer-systems-interface-iscsi","title":"6.4 Connect to Network Attached Storage (NAS) via Network File System (NFS) and Internet Small Computer Systems Interface (iSCSI)","text":"<p>NAS01 provides NFS and iSCSI (primary datastore), while NAS02 provides NFS for media only. GPU01\u2019s NVMe is used as a temporary datastore until NAS01 rebuild is complete.</p>"},{"location":"06-Proxmox-Cluster-Setup/#validation_5","title":"Validation","text":"<ul> <li> Network File System (NFS) mount verified</li> <li> Internet Small Computer Systems Interface (iSCSI) Logical Unit Number (LUN) attached \ud83c\udfc6 Achievement Unlocked: Shared storage online!</li> </ul>"},{"location":"06-Proxmox-Cluster-Setup/#64b-validate-nas-storage-exports","title":"6.4b Validate NAS storage exports","text":"<p>Ensure NAS01 and NAS02 are correctly serving iSCSI and NFS before cluster integration.</p>"},{"location":"06-Proxmox-Cluster-Setup/#steps_1","title":"Steps","text":"<ol> <li>From GPU01:    <pre><code>nc -zv 172.16.30.5 3260     # iSCSI target on NAS01\nshowmount -e 172.16.30.5   # NFS exports on NAS01\nshowmount -e 172.16.30.4   # NFS exports on NAS02\n</code></pre></li> <li>Confirm expected exports:</li> <li>NAS01: <code>vm-store</code>, <code>pbs-ds</code>, optional templates path</li> <li>NAS02: <code>/Media</code> (RAID5 media share)</li> <li>Document export names and paths for Ansible/Terraform use.</li> </ol>"},{"location":"06-Proxmox-Cluster-Setup/#validation_6","title":"Validation","text":"<ul> <li> NAS01 iSCSI target responds</li> <li> NAS01 NFS exports visible</li> <li> NAS02 NFS export <code>/Media</code> visible \ud83c\udfc6 Achievement Unlocked: Storage exports online!</li> </ul>"},{"location":"06-Proxmox-Cluster-Setup/#65-set-up-nightly-snapshots-to-proxmox-backup-server-pbsnas-and-offsite-optional","title":"6.5 Set up nightly snapshots to Proxmox Backup Server (PBS)/NAS (and offsite optional)","text":"<p>PBS plan: Run PBS as a VM on GPU01. Primary datastore on NAS01 via iSCSI. Network on VLAN 15. Retention: daily 7, weekly 4, monthly 6. Enable prune and verify.</p> <p>Implementation steps 1. DNS: reserve <code>pbs01.&lt;your-domain&gt;</code> on VLAN 15. IP example: <code>172.16.15.50</code>. 2. NAS01 iSCSI: create target + LUN for <code>pbs-ds</code> on the storage pool you dedicate to backups. 3. Proxmox (GPU01): create <code>pbs01</code> VM, attach iSCSI LUN as a disk, format XFS or ext4 inside VM. 4. PBS setup: add datastore <code>pbs-ds</code>, set retention <code>7/4/6</code>, schedule Verify weekly, Prune weekly. 5. Proxmox jobs: create backup jobs for critical VMs/CTs to <code>pbs-ds</code>. Stagger schedules to avoid contention. 6. Optional offsite: later add cloud sync or a secondary NAS mirror for ransomware resilience.</p> <p>PBS hosting options | Option | Pros | Cons | |---|---|---| | VM on Proxmox, datastore on NAS01 (iSCSI) | Supported, simple upgrades, fast LAN | Consumes host CPU/RAM; depends on NAS01 | | Small dedicated box, datastore on NAS01 | Isolates PBS OS from hypervisors | Extra hardware; still one storage backend | | Docker on NAS01 | No extra hardware | Unsupported by Proxmox; feature breakage risk on upgrades |</p>"},{"location":"06-Proxmox-Cluster-Setup/#validation_7","title":"Validation","text":"<ul> <li> Backup snapshot completed \ud83c\udfc6 Achievement Unlocked: Snapshots scheduled!</li> </ul>"},{"location":"06-Proxmox-Cluster-Setup/#66-deploy-3-node-consul-vault-clusters-spread-across-nodes","title":"6.6 Deploy 3-node Consul + Vault clusters spread across nodes","text":""},{"location":"06-Proxmox-Cluster-Setup/#validation_8","title":"Validation","text":"<ul> <li> Consul cluster booted</li> <li> Vault cluster sealed and reachable \ud83c\udfc6 Achievement Unlocked: Service backbone deployed!</li> </ul>"},{"location":"06-Proxmox-Cluster-Setup/#67-automation-skeletons-copypaste","title":"6.7 Automation skeletons (copy/paste)","text":""},{"location":"06-Proxmox-Cluster-Setup/#ansible-cluster-storage-minimal-skeleton","title":"Ansible (cluster + storage) \u2014 minimal skeleton","text":"<p><code>inventories/hosts.yml</code> <pre><code>all:\n  vars:\n    api_user: \"root@pam\"\n    api_token_id: \"{{ lookup('env','PVE_TOKEN_ID') }}\"\n    api_token_secret: \"{{ lookup('env','PVE_TOKEN_SECRET') }}\"\n    validate_certs: false\n    gpu01_mgmt_ip: \"172.16.15.10\"\n  children:\n    pve:\n      hosts:\n        gpu01: { ansible_host: \"172.16.15.10\", corosync_link0_ip: \"172.16.12.10\" }\n        nuc01: { ansible_host: \"172.16.15.11\", corosync_link0_ip: \"172.16.12.11\" }\n        nuc02: { ansible_host: \"172.16.15.12\", corosync_link0_ip: \"172.16.12.12\" }\n</code></pre></p> <p><code>playbooks/10_cluster_bootstrap.yml</code> <pre><code>- hosts: gpu01\n  gather_facts: false\n  tasks:\n    - name: Create cluster on GPU01\n      community.proxmox.proxmox_cluster:\n        state: present\n        api_host: \"{{ gpu01_mgmt_ip }}\"\n        api_user: \"{{ api_user }}\"\n        api_token_id: \"{{ api_token_id }}\"\n        api_token_secret: \"{{ api_token_secret }}\"\n        cluster_name: \"pve-cluster01\"\n        link0: \"{{ hostvars['gpu01'].corosync_link0_ip }}\"  # VLAN 12\n\n- hosts: nuc01,nuc02\n  gather_facts: false\n  tasks:\n    - name: Join cluster\n      community.proxmox.proxmox_cluster:\n        state: present\n        api_host: \"{{ inventory_hostname }}\"\n        api_user: \"{{ api_user }}\"\n        api_token_id: \"{{ api_token_id }}\"\n        api_token_secret: \"{{ api_token_secret }}\"\n        master_ip: \"{{ gpu01_mgmt_ip }}\"\n        link0: \"{{ hostvars[inventory_hostname].corosync_link0_ip }}\"  # VLAN 12\n        # fingerprint: \"&lt;paste GPU01 API TLS fingerprint&gt;\"\n</code></pre></p> <p><code>playbooks/20_storage.yml</code> <pre><code>- hosts: gpu01\n  gather_facts: false\n  tasks:\n    - name: Add NAS01 iSCSI portal\n      community.proxmox.proxmox_storage:\n        api_host: \"{{ hostvars['gpu01'].ansible_host }}\"\n        api_user: \"{{ api_user }}\"\n        api_token_id: \"{{ api_token_id }}\"\n        api_token_secret: \"{{ api_token_secret }}\"\n        name: \"nas01-iscsi\"\n        type: \"iscsi\"\n        portal: \"172.16.30.5\"\n        target: \"iqn.2000-01.com.synology:nas01.pve\"   # placeholder\n        content: \"images,rootdir\"\n\n    - name: Add LVM-Thin on iSCSI LUN (placeholder values)\n      community.proxmox.proxmox_storage:\n        api_host: \"{{ hostvars['gpu01'].ansible_host }}\"\n        api_user: \"{{ api_user }}\"\n        api_token_id: \"{{ api_token_id }}\"\n        api_token_secret: \"{{ api_token_secret }}\"\n        name: \"vmstore\"\n        type: \"lvmthin\"\n        vgname: \"vg_vmstore\"\n        thinpool: \"thin_vmstore\"\n        base: \"/dev/mapper/&lt;your-iscsi-lun-mapper&gt;\"\n        content: \"images,rootdir\"\n\n    - name: Add NFS (templates) from NAS01\n      community.proxmox.proxmox_storage:\n        api_host: \"{{ hostvars['gpu01'].ansible_host }}\"\n        api_user: \"{{ api_user }}\"\n        api_token_id: \"{{ api_token_id }}\"\n        api_token_secret: \"{{ api_token_secret }}\"\n        name: \"nas01-nfs-templates\"\n        type: \"nfs\"\n        server: \"172.16.30.5\"\n        export: \"/volumeX/pve-templates\"   # placeholder path\n        options: \"vers=4.1\"\n        content: \"iso,vztmpl,snippets\"\n\n    - name: Add NFS (media) from NAS02\n      community.proxmox.proxmox_storage:\n        api_host: \"{{ hostvars['gpu01'].ansible_host }}\"\n        api_user: \"{{ api_user }}\"\n        api_token_id: \"{{ api_token_id }}\"\n        api_token_secret: \"{{ api_token_secret }}\"\n        name: \"nas02-media\"\n        type: \"nfs\"\n        server: \"172.16.30.4\"\n        export: \"/mnt/media\"   # placeholder path\n        options: \"vers=4.1\"\n        content: \"backup\"\n</code></pre></p> <p><code>playbooks/15_enable_ha_watchdog.yml</code> <pre><code>- hosts: pve\n  gather_facts: false\n  become: true\n  tasks:\n    - name: Check for hardware watchdog device\n      command: bash -lc \"ls -1 /dev/watchdog* 2&gt;/dev/null || true\"\n      register: wd_devices\n      changed_when: false\n\n    - name: Decide if softdog is required\n      set_fact:\n        need_softdog: \"{{ wd_devices.stdout_lines | length == 0 }}\"\n\n    - name: Load softdog when no hardware watchdog is present\n      when: need_softdog\n      modprobe:\n        name: softdog\n        state: present\n\n    - name: Persist softdog module across reboots\n      when: need_softdog\n      copy:\n        dest: /etc/modules-load.d/watchdog.conf\n        content: \"softdog\\n\"\n        owner: root\n        group: root\n        mode: '0644'\n\n    - name: Enable and start Proxmox HA services\n      systemd:\n        name: \"{{ item }}\"\n        enabled: true\n        state: started\n      loop:\n        - pve-ha-lrm\n        - pve-ha-crm\n\n    - name: Assert HA services are healthy\n      command: systemctl is-active {{ item }}\n      register: ha_status\n      changed_when: false\n      failed_when: ha_status.rc != 0\n      loop:\n        - pve-ha-lrm\n        - pve-ha-crm\n</code></pre></p>"},{"location":"06-Proxmox-Cluster-Setup/#terraform-bpgproxmox-minimal-skeleton","title":"Terraform (bpg/proxmox) \u2014 minimal skeleton","text":"<p><code>terraform/providers.tf</code> <pre><code>terraform {\n  required_providers {\n    proxmox = { source = \"bpg/proxmox\", version = \"~&gt; 0.49\" }\n  }\n}\nprovider \"proxmox\" {\n  endpoint = \"https://172.16.15.10:8006/\"\n  username = \"root@pam\"\n  api_token = var.api_token\n  insecure  = true\n}\nvariable \"api_token\" { type = string }\n</code></pre></p> <p><code>terraform/pbs01.tf</code> (upload PBS ISO to a datastore first) <pre><code>resource \"proxmox_virtual_environment_vm\" \"pbs01\" {\n  name      = \"pbs01\"\n  node_name = \"GPU01\"\n  tags      = [\"pbs\"]\n  cpu { cores = 2 }\n  memory { dedicated = 4096 }\n\n  disk {\n    datastore_id = \"vmstore\"   # local or iSCSI-backed LVM-thin\n    interface    = \"scsi0\"\n    size         = 16\n  }\n\n  cdrom {\n    file_id = \"local:iso/proxmox-backup-server_*.iso\"  # upload ISO\n  }\n\n  network_device {\n    bridge  = \"vmbr0\"\n    vlan_id = 15\n  }\n\n  initialization {\n    user_account { username = \"root\" }\n    ip_config {\n      ipv4 { address = \"172.16.15.50/24\", gateway = \"172.16.15.1\" }\n    }\n    dns { servers = [\"172.16.15.1\"] }\n  }\n}\n</code></pre></p>"},{"location":"06-Proxmox-Cluster-Setup/#68-ha-fencing-and-watchdog-validation","title":"6.8 HA Fencing and Watchdog Validation","text":"<p>Proxmox HA relies on a watchdog device. If no hardware watchdog exists, enable the kernel softdog module.</p>"},{"location":"06-Proxmox-Cluster-Setup/#steps_2","title":"Steps","text":"<ol> <li>Detect watchdog (on each node) <pre><code>ls -l /dev/watchdog* || true\nlsmod | grep -i watchdog || true\ndmesg | grep -i watchdog || true\n</code></pre></li> <li>Enable softdog if no hardware watchdog is present <pre><code>sudo modprobe softdog\n# make persistent across reboots\necho softdog | sudo tee /etc/modules-load.d/watchdog.conf\n</code></pre></li> <li>Start Proxmox HA services <pre><code>sudo systemctl enable --now pve-ha-lrm pve-ha-crm\nsudo systemctl status pve-ha-lrm pve-ha-crm --no-pager\n</code></pre> <p>If <code>pve-ha-lrm</code>/<code>pve-ha-crm</code> previously logged \u201cunable to write lrm status file\u201d while the cluster filesystem was down, those errors should clear once quorum and <code>/etc/pve</code> are healthy again.</p> </li> <li>Confirm watchdog is active in HA logs <pre><code>journalctl -u pve-ha-lrm --since \"5 min ago\" | grep -i watchdog || true\n</code></pre></li> <li>Optional: quick HA group smoke test <pre><code># create an HA group preferring GPU01, then NUC01, then NUC02\nha-manager group add core pref=GPU01,Nuc01,Nuc02\n# add a non-critical test VM to HA (replace 101 with a test VMID)\nha-manager add vm:101 --group core --state started\nha-manager status\n</code></pre> Note: Do not simulate failures yet. This is a non-disruptive verification only.</li> </ol> <p>Automation: You can run <code>ansible-playbook playbooks/15_enable_ha_watchdog.yml</code> to perform steps 2\u20133 on all nodes.</p>"},{"location":"06-Proxmox-Cluster-Setup/#validation_9","title":"Validation","text":"<ul> <li> <code>/dev/watchdog</code> exists on all nodes</li> <li> <code>softdog</code> loaded where no hardware watchdog is available</li> <li> <code>pve-ha-lrm</code> and <code>pve-ha-crm</code> are active</li> <li> <code>ha-manager status</code> returns without errors</li> <li> Ansible playbook <code>playbooks/15_enable_ha_watchdog.yml</code> executed successfully on all nodes</li> </ul>"},{"location":"06-Proxmox-Cluster-Setup/#fencing-approaches-quick-comparison","title":"Fencing approaches \u2014 quick comparison","text":"Approach Pros Cons Hardware watchdog (board/CPU vendor) Fast, reliable fencing; minimal CPU May not exist on NUCs; driver quirks softdog kernel module Universal, simple to enable Software-based; lower assurance than hardware No watchdog (not recommended) Zero setup HA cannot fence, risk of split-brain; HA disabled <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"07-CI-CD-for-Terraform/","title":"CI/CD for Terraform","text":""},{"location":"07-CI-CD-for-Terraform/#overview","title":"Overview","text":"<p>TBD: brief purpose of this chapter.</p>"},{"location":"07-CI-CD-for-Terraform/#outcomes","title":"Outcomes","text":"<ul> <li>TBD</li> </ul>"},{"location":"07-CI-CD-for-Terraform/#entry-checks","title":"Entry Checks","text":"<ul> <li>TBD</li> </ul>"},{"location":"07-CI-CD-for-Terraform/#labs","title":"Labs","text":"<ul> <li>TBD</li> </ul>"},{"location":"07-CI-CD-for-Terraform/#validation","title":"Validation","text":"<ul> <li> TBD</li> </ul>"},{"location":"07-CI-CD-for-Terraform/#exit-criteria","title":"Exit Criteria","text":"<ul> <li> TBD</li> </ul>"},{"location":"07-CI-CD-for-Terraform/#next","title":"Next","text":"<p>TBD</p> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"08-Image-Factory/","title":"Image Factory","text":""},{"location":"08-Image-Factory/#overview","title":"Overview","text":"<p>TBD: brief purpose of this chapter.</p>"},{"location":"08-Image-Factory/#outcomes","title":"Outcomes","text":"<ul> <li>TBD</li> </ul>"},{"location":"08-Image-Factory/#entry-checks","title":"Entry Checks","text":"<ul> <li>TBD</li> </ul>"},{"location":"08-Image-Factory/#labs","title":"Labs","text":"<ul> <li>TBD</li> </ul>"},{"location":"08-Image-Factory/#validation","title":"Validation","text":"<ul> <li> TBD</li> </ul>"},{"location":"08-Image-Factory/#exit-criteria","title":"Exit Criteria","text":"<ul> <li> TBD</li> </ul>"},{"location":"08-Image-Factory/#next","title":"Next","text":"<p>TBD</p> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"09-Core-Infra-VMs/","title":"Core Infra VMs","text":""},{"location":"09-Core-Infra-VMs/#overview","title":"Overview","text":"<p>TBD: brief purpose of this chapter.</p>"},{"location":"09-Core-Infra-VMs/#outcomes","title":"Outcomes","text":"<ul> <li>TBD</li> </ul>"},{"location":"09-Core-Infra-VMs/#entry-checks","title":"Entry Checks","text":"<ul> <li>TBD</li> </ul>"},{"location":"09-Core-Infra-VMs/#labs","title":"Labs","text":"<ul> <li>TBD</li> </ul>"},{"location":"09-Core-Infra-VMs/#validation","title":"Validation","text":"<ul> <li> TBD</li> </ul>"},{"location":"09-Core-Infra-VMs/#exit-criteria","title":"Exit Criteria","text":"<ul> <li> TBD</li> </ul>"},{"location":"09-Core-Infra-VMs/#next","title":"Next","text":"<p>TBD</p> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"10-Docker-Swarm-Cluster/","title":"Docker Swarm Cluster","text":""},{"location":"10-Docker-Swarm-Cluster/#overview","title":"Overview","text":"<p>TBD: brief purpose of this chapter.</p>"},{"location":"10-Docker-Swarm-Cluster/#outcomes","title":"Outcomes","text":"<ul> <li>TBD</li> </ul>"},{"location":"10-Docker-Swarm-Cluster/#entry-checks","title":"Entry Checks","text":"<ul> <li>TBD</li> </ul>"},{"location":"10-Docker-Swarm-Cluster/#labs","title":"Labs","text":"<ul> <li>TBD</li> </ul>"},{"location":"10-Docker-Swarm-Cluster/#validation","title":"Validation","text":"<ul> <li> TBD</li> </ul>"},{"location":"10-Docker-Swarm-Cluster/#exit-criteria","title":"Exit Criteria","text":"<ul> <li> TBD</li> </ul>"},{"location":"10-Docker-Swarm-Cluster/#next","title":"Next","text":"<p>TBD</p> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"11-Traefik-Authentik-Public-DNS-VPN/","title":"Traefik + Authentik + Public DNS + VPN","text":""},{"location":"11-Traefik-Authentik-Public-DNS-VPN/#overview","title":"Overview","text":"<p>TBD: brief purpose of this chapter.</p>"},{"location":"11-Traefik-Authentik-Public-DNS-VPN/#outcomes","title":"Outcomes","text":"<ul> <li>TBD</li> </ul>"},{"location":"11-Traefik-Authentik-Public-DNS-VPN/#entry-checks","title":"Entry Checks","text":"<ul> <li>TBD</li> </ul>"},{"location":"11-Traefik-Authentik-Public-DNS-VPN/#labs","title":"Labs","text":"<ul> <li>TBD</li> </ul>"},{"location":"11-Traefik-Authentik-Public-DNS-VPN/#validation","title":"Validation","text":"<ul> <li> TBD</li> </ul>"},{"location":"11-Traefik-Authentik-Public-DNS-VPN/#exit-criteria","title":"Exit Criteria","text":"<ul> <li> TBD</li> </ul>"},{"location":"11-Traefik-Authentik-Public-DNS-VPN/#next","title":"Next","text":"<p>TBD</p> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"12-Integration-Pass-1/","title":"Integration Pass #1","text":""},{"location":"12-Integration-Pass-1/#overview","title":"Overview","text":"<p>TBD: brief purpose of this chapter.</p>"},{"location":"12-Integration-Pass-1/#outcomes","title":"Outcomes","text":"<ul> <li>TBD</li> </ul>"},{"location":"12-Integration-Pass-1/#entry-checks","title":"Entry Checks","text":"<ul> <li>TBD</li> </ul>"},{"location":"12-Integration-Pass-1/#labs","title":"Labs","text":"<ul> <li>TBD</li> </ul>"},{"location":"12-Integration-Pass-1/#validation","title":"Validation","text":"<ul> <li> TBD</li> </ul>"},{"location":"12-Integration-Pass-1/#exit-criteria","title":"Exit Criteria","text":"<ul> <li> TBD</li> </ul>"},{"location":"12-Integration-Pass-1/#next","title":"Next","text":"<p>TBD</p> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"13-Migrations-and-Refactor/","title":"Migration Checkpoints","text":"<ul> <li>Terraform state \u2192 HCP to Consul</li> <li>Vault secrets \u2192 HCP Vault to local Vault</li> <li>Runs \u2192 Cloud CI to local runners (optional)</li> <li>DNS/TLS \u2192 Cloudflare to local split-horizon</li> </ul> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"14-Observability-and-Alerting/","title":"Observability","text":""},{"location":"14-Observability-and-Alerting/#overview","title":"Overview","text":"<p>Prometheus, Loki, Grafana. Alerting to Slack/email/SMS.</p>"},{"location":"14-Observability-and-Alerting/#outcomes","title":"Outcomes","text":"<ul> <li>Metrics and logs for core services</li> <li>Alerts routed to Slack/email/SMS</li> </ul>"},{"location":"14-Observability-and-Alerting/#labs","title":"Labs","text":"<p>1) Deploy Prometheus + Grafana 2) Add Loki + promtail 3) Configure alert routes (Slack first)</p>"},{"location":"14-Observability-and-Alerting/#validation","title":"Validation","text":"<ul> <li>Dashboards show live targets</li> <li>Test alert fires to Slack</li> </ul>"},{"location":"14-Observability-and-Alerting/#next","title":"Next","text":"<p>\u2192 Ops Readiness</p> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"15-Ops-Readiness/","title":"Ops Readiness","text":""},{"location":"15-Ops-Readiness/#overview","title":"Overview","text":"<p>TBD: brief purpose of this chapter.</p>"},{"location":"15-Ops-Readiness/#outcomes","title":"Outcomes","text":"<ul> <li>TBD</li> </ul>"},{"location":"15-Ops-Readiness/#entry-checks","title":"Entry Checks","text":"<ul> <li>TBD</li> </ul>"},{"location":"15-Ops-Readiness/#labs","title":"Labs","text":"<ul> <li>TBD</li> </ul>"},{"location":"15-Ops-Readiness/#validation","title":"Validation","text":"<ul> <li> TBD</li> </ul>"},{"location":"15-Ops-Readiness/#exit-criteria","title":"Exit Criteria","text":"<ul> <li> TBD</li> </ul>"},{"location":"15-Ops-Readiness/#next","title":"Next","text":"<p>TBD</p> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"16-Local-DNS/","title":"Local DNS","text":""},{"location":"16-Local-DNS/#overview","title":"Overview","text":"<p>TBD: brief purpose of this chapter.</p>"},{"location":"16-Local-DNS/#outcomes","title":"Outcomes","text":"<ul> <li>TBD</li> </ul>"},{"location":"16-Local-DNS/#entry-checks","title":"Entry Checks","text":"<ul> <li>TBD</li> </ul>"},{"location":"16-Local-DNS/#labs","title":"Labs","text":"<ul> <li>TBD</li> </ul>"},{"location":"16-Local-DNS/#validation","title":"Validation","text":"<ul> <li> TBD</li> </ul>"},{"location":"16-Local-DNS/#exit-criteria","title":"Exit Criteria","text":"<ul> <li> TBD</li> </ul>"},{"location":"16-Local-DNS/#next","title":"Next","text":"<p>TBD</p> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"17-DMZ-and-Routing/","title":"DMZ &amp; Routing","text":""},{"location":"17-DMZ-and-Routing/#overview","title":"Overview","text":"<p>TBD: brief purpose of this chapter.</p>"},{"location":"17-DMZ-and-Routing/#outcomes","title":"Outcomes","text":"<ul> <li>TBD</li> </ul>"},{"location":"17-DMZ-and-Routing/#entry-checks","title":"Entry Checks","text":"<ul> <li>TBD</li> </ul>"},{"location":"17-DMZ-and-Routing/#labs","title":"Labs","text":"<ul> <li>TBD</li> </ul>"},{"location":"17-DMZ-and-Routing/#validation","title":"Validation","text":"<ul> <li> TBD</li> </ul>"},{"location":"17-DMZ-and-Routing/#exit-criteria","title":"Exit Criteria","text":"<ul> <li> TBD</li> </ul>"},{"location":"17-DMZ-and-Routing/#next","title":"Next","text":"<p>TBD</p> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"18-Public-Status-Page-and-Alerting/","title":"Public Status Page + Alerting","text":""},{"location":"18-Public-Status-Page-and-Alerting/#overview","title":"Overview","text":"<p>TBD: brief purpose of this chapter.</p>"},{"location":"18-Public-Status-Page-and-Alerting/#outcomes","title":"Outcomes","text":"<ul> <li>TBD</li> </ul>"},{"location":"18-Public-Status-Page-and-Alerting/#entry-checks","title":"Entry Checks","text":"<ul> <li>TBD</li> </ul>"},{"location":"18-Public-Status-Page-and-Alerting/#labs","title":"Labs","text":"<ul> <li>TBD</li> </ul>"},{"location":"18-Public-Status-Page-and-Alerting/#validation","title":"Validation","text":"<ul> <li> TBD</li> </ul>"},{"location":"18-Public-Status-Page-and-Alerting/#exit-criteria","title":"Exit Criteria","text":"<ul> <li> TBD</li> </ul>"},{"location":"18-Public-Status-Page-and-Alerting/#next","title":"Next","text":"<p>TBD</p> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"19-Workloads/","title":"First Workloads","text":""},{"location":"19-Workloads/#overview","title":"Overview","text":"<p>Plex, Game Servers, Family Photos. SSO, TLS, backups, monitors.</p>"},{"location":"19-Workloads/#outcomes","title":"Outcomes","text":"<ul> <li>Core apps deployed on Swarm</li> <li>Routed via Traefik with Authentik SSO</li> <li>Backups and monitors active</li> </ul>"},{"location":"19-Workloads/#labs","title":"Labs","text":"<p>1) Deploy Plex with media share 2) Deploy Minecraft Java and Bedrock 3) Deploy photo/video service</p>"},{"location":"19-Workloads/#validation","title":"Validation","text":"<ul> <li>SSO enforced on at least one admin app and one family app</li> <li>Dashboards and alerts live</li> </ul>"},{"location":"19-Workloads/#next","title":"Next","text":"<p>\u2192 Traefik + Authentik + Public DNS + VPN</p> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"20-Graduation/","title":"Release Policy (Tags off <code>main</code>)","text":""},{"location":"20-Graduation/#overview","title":"Overview","text":"<ul> <li>Source of truth: <code>main</code> branch.</li> <li>Releases are annotated git tags on <code>main</code> (format: <code>vMAJOR.MINOR.PATCH</code>).</li> <li>No long\u2011lived release branches. Only <code>main</code> and <code>gh-pages</code> exist.</li> </ul>"},{"location":"20-Graduation/#preconditions","title":"Preconditions","text":"<ul> <li><code>main</code> is green in CI.</li> <li>Local tree is clean and on <code>main</code>.</li> <li>You have push access to tags.</li> </ul>"},{"location":"20-Graduation/#create-a-release-tag","title":"Create a release tag","text":"<pre><code># pick the next version\nexport TAG=v0.1.0\n\n# from repo root\ngit checkout main\ngit pull --ff-only\n\ngit tag -a \"$TAG\" -m \"$TAG\"\ngit push origin \"$TAG\"\n</code></pre>"},{"location":"20-Graduation/#optional-github-release-from-the-tag","title":"Optional: GitHub Release from the tag","text":"<pre><code># requires GitHub CLI (gh)\ngh release create \"$TAG\" --generate-notes --latest\n</code></pre>"},{"location":"20-Graduation/#versioning","title":"Versioning","text":"<ul> <li>Use Semantic Versioning: MAJOR.MINOR.PATCH.</li> <li>Bump MAJOR for incompatible changes, MINOR for backwards-compatible docs/features, PATCH for fixes.</li> </ul>"},{"location":"20-Graduation/#rollback","title":"Rollback","text":"<pre><code># remove the remote tag (be careful)\ngit push origin :refs/tags/$TAG\n# remove local tag\ngit tag -d $TAG\n</code></pre>"},{"location":"20-Graduation/#verify","title":"Verify","text":"<ul> <li>Tag appears at https://github.com/MichaelHeaton/homelab-infra/tags</li> <li>Pages build still passes.</li> </ul> <p>.PHONY: release release-dry-run release-gh</p>"},{"location":"20-Graduation/#create-an-annotated-tag-from-main-and-push-it","title":"Create an annotated tag from main and push it","text":"<pre><code># Usage: make release TAG=v0.1.0\n</code></pre> <p>release:     @test -n \"$(TAG)\" || (echo \"TAG required, e.g., make release TAG=v0.1.0\" &amp;&amp; exit 1)     @current=$$(git rev-parse --abbrev-ref HEAD); \\      if [ \"$$current\" != \"main\" ]; then echo \"checkout main (current: $$current)\" &amp;&amp; exit 1; fi     @status=$$(git status --porcelain); \\      if [ -n \"$$status\" ]; then echo \"working tree dirty\" &amp;&amp; exit 1; fi     @git fetch origin &amp;&amp; git pull --ff-only     @git tag -a $(TAG) -m \"$(TAG)\"     @git push origin $(TAG)     @echo \"Tag $(TAG) pushed to origin\"</p>"},{"location":"20-Graduation/#dry-run-helper","title":"Dry-run helper","text":"<p>release-dry-run:     @echo \"Would tag current main as $(TAG) and push to origin\"</p>"},{"location":"20-Graduation/#optional-create-a-github-release-from-the-tag-requires-gh","title":"Optional: create a GitHub Release from the tag (requires gh)","text":"<pre><code># Usage: make release-gh TAG=v0.1.0\n</code></pre> <p>release-gh:     @test -n \"$(TAG)\" || (echo \"TAG required, e.g., make release-gh TAG=v0.1.0\" &amp;&amp; exit 1)     @command -v gh &gt;/dev/null 2&gt;&amp;1 || (echo \"GitHub CLI 'gh' not found\" &amp;&amp; exit 1)     @gh release create $(TAG) --generate-notes --latest     @echo \"GitHub Release created for $(TAG)\"</p> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"21-Lab-and-Service-Ideas/","title":"Lab &amp; Service Ideas","text":"<p>Curated backlog for future labs and services. Prioritize as needed.</p>"},{"location":"21-Lab-and-Service-Ideas/#media-and-home-services","title":"Media and Home Services","text":"<ul> <li>Full automated Plex service (Usenet-only): Plex + Sonarr/Radarr/Lidarr + NZBGet/SABnzbd + Recyclarr. Exclude torrent clients to avoid ISP issues.</li> <li>Image Management &amp; Google Takeout Cleanup: Immich or PhotoPrism, with EXIF normalization and deduplication pipeline.</li> <li>DVD/Blu\u2011ray conversion for Plex: MakeMKV + HandBrake + (optional) Tdarr for transcode automation.</li> </ul>"},{"location":"21-Lab-and-Service-Ideas/#gaming","title":"Gaming","text":"<ul> <li>Local Game Servers: Minecraft, Valheim, Palworld, Factorio. Containerized with Portainer or Swarm stacks.</li> </ul>"},{"location":"21-Lab-and-Service-Ideas/#ai-and-tools","title":"AI and Tools","text":"<ul> <li>Private Local AI service: Ollama + Open WebUI (text) and ComfyUI/InvokeAI (images). GPU optional.</li> <li>Ticket system: GLPI or Zammad for helpdesk plus inventory.</li> <li>Local AI Doctor: OpenHealthForAll \u2013 https://github.com/OpenHealthForAll/open-health</li> </ul>"},{"location":"21-Lab-and-Service-Ideas/#notes","title":"Notes","text":"<ul> <li>Prefer bind mounts on your <code>docker-lun</code> for persistence.</li> <li>Centralize secrets in Vault once deployed.</li> <li>Use Traefik labels for uniform ingress naming.</li> </ul> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"CONTRIBUTING/","title":"CONTRIBUTING","text":"<p>Quick Overview</p> <p>What: Contribution guidelines for the Homelab Infra campaign. Why: Ensures every page stays consistent, clear, and fun. Time: 5\u201310 minutes to review before contributing. XP: +10 (like Whose Line, the points are made up but the fun is real).</p>"},{"location":"CONTRIBUTING/#contributingmd","title":"CONTRIBUTING.md","text":""},{"location":"CONTRIBUTING/#contributing-to-homelab-infra-documentation","title":"Contributing to Homelab Infra Documentation","text":"<p>Contributing here is like joining the party. These rules keep our quest log consistent, fun, and easy to follow.</p> <p>Welcome to the Homelab Infra documentation project! We\u2019re excited to have you help us build a clear, engaging, and technically sound guide for homelab enthusiasts.</p>"},{"location":"CONTRIBUTING/#style-guide-and-writing-principles","title":"Style Guide and Writing Principles","text":""},{"location":"CONTRIBUTING/#canonical-section-order","title":"Canonical Section Order","text":"<ul> <li><code>Entry Checks \u2192 Outcomes \u2192 Story Intro \u2192 Labs \u2192 Validation \u2192 Exit Criteria</code></li> <li><code>Each section should open with a 1\u20133 line story intro to frame the purpose</code></li> <li><code>Labs should use hierarchical numbering (e.g., 3.1, 3.2, 3.3). Do not renumber earlier labs when adding new ones.</code></li> <li><code>Footer nav only. Do not add inline \u201c## Next/Previous\u201d sections.</code></li> </ul>"},{"location":"CONTRIBUTING/#theme-and-voice","title":"Theme and Voice","text":"<ul> <li>Friendly and approachable: Write as if guiding a fellow sysadmin adventurer on a quest, not a corporate manual.</li> <li>Clear and concise: Avoid unnecessary jargon; explain terms when first introduced.</li> <li>Encouraging and empowering: Inspire readers to experiment and learn.</li> <li>Consistent tone: Maintain an enthusiastic yet professional style throughout.</li> </ul>"},{"location":"CONTRIBUTING/#formatting","title":"Formatting","text":"<ul> <li>Use Markdown for all content.</li> <li>Headings should be clear and descriptive.</li> <li>Use bullet points and numbered lists for steps and enumerations.</li> <li>Emphasize important terms or concepts with bold or italic styles.</li> <li>Include emojis sparingly to enhance readability and engagement.</li> <li>Use front-matter <code>icon:</code> for page-level theming.</li> </ul>"},{"location":"CONTRIBUTING/#dat-define-acronyms-and-terms","title":"DAT: Define Acronyms and Terms","text":"<ul> <li>Always define acronyms and technical terms on first use.</li> <li>Use the DAT (Define Acronyms and Terms) section or inline explanations.</li> <li>Link to the Glossary for comprehensive definitions.</li> <li>Always add new acronyms to Glossary under Terms.</li> <li>Keep the Glossary in strict alphabetical order for consistency.</li> <li>Expand acronyms only on first use in each doc, then rely on Glossary and Abbreviations for consistency.</li> </ul>"},{"location":"CONTRIBUTING/#do-you-want-to-know-more-rule","title":"\"Do You Want To Know More?\" Rule","text":"<ul> <li>At the end of chapters or major sections, include a Do You Want To Know More? section.</li> <li>Provide links to related resources, deeper dives, or advanced topics.</li> <li>Include related certifications and training resources for readers who may not know what to look for.</li> <li>This encourages continuous learning without overwhelming the main narrative.</li> </ul>"},{"location":"CONTRIBUTING/#technical-grounding","title":"Technical Grounding","text":"<ul> <li>Ensure all instructions and explanations are accurate and verifiable.</li> <li>Test commands, configurations, and code snippets before inclusion.</li> <li>Cite sources or references when applicable.</li> <li>Keep the content up to date with the latest best practices and tools.</li> <li>Link product setup to vendor how-to and training documentation when possible, so the guide stays current with new versions.</li> </ul>"},{"location":"CONTRIBUTING/#page-structure","title":"Page Structure","text":"<ul> <li>Start with ## Entry Checks and ## Outcomes before any narrative.</li> <li>Follow with a short story-style introduction that frames the chapter in the journey.</li> <li>Organize Labs into subsections with hierarchical numbering (e.g., 4.1, 4.2).</li> <li>Include Validation and Exit Criteria checklists.</li> <li>Do not include inline navigation; rely on footer nav.</li> </ul>"},{"location":"CONTRIBUTING/#file-naming-conventions","title":"File Naming Conventions","text":"<ul> <li>Use <code>-</code> (dash) not <code>_</code> (underscore).</li> <li>Keep names lowercase.</li> <li>Make filenames descriptive but concise.</li> <li>Align naming with levels/chapters (e.g., <code>workstation-setup.md</code>, <code>phase1-foundations.md</code>).</li> </ul> <p>Thank you for contributing to making this homelab documentation a valuable resource for everyone!</p>"},{"location":"CONTRIBUTING/#navigation-policy","title":"Navigation Policy","text":"<ul> <li>Footer navigation is the source of truth for Previous/Next.</li> <li>Inline navigation blocks should be removed from all pages.</li> </ul> <p>\ud83c\udf89 Contribution Complete! You\u2019ve earned +10 XP for keeping the docs awesome (points don\u2019t matter, but your effort does).</p> <p>Remember: consistency keeps the quest log readable\u2014points may not matter, but style does.</p> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"ai-context/","title":"AI Context (Decisions &amp; Repo Map)","text":"<p>Quick Overview</p> <p>What: Central AI context, decisions, and repo map for collaboration. Why: Keeps sessions reproducible, consistent, and aligned. Time: Ongoing; updated whenever structure or rules change. XP: +20 (like Whose Line, the points are made up but the fun is real).</p> <p>This is the brain of the campaign\u2014AI collaboration rules, decision logs, and the canonical repo map.</p>"},{"location":"ai-context/#decision-log","title":"Decision Log","text":"<p>No pending decisions. This section is cleared on each repo update. New decisions are appended here until the next run.</p> <ul> <li>The Glossary (<code>docs/glossary.md</code>) should be maintained in strict alphabetical order.</li> </ul>"},{"location":"ai-context/#standing-rules","title":"Standing Rules","text":"<ul> <li>File Focus: Respect the declared File Focus before editing. Do not touch other files unless requested.</li> <li>Lab Order by Dependency: Order labs so dependencies come first. Example: Consul before Vault.</li> <li>Abbreviations: Centralize in <code>docs/includes/abbreviations.md</code>. Each page should include them at the top using   <code>--8&lt;-- \"includes/abbreviations.md\"</code>.</li> <li>Glossary Hygiene: When a new tool or protocol appears, add it to <code>docs/glossary.md</code> and keep terms strictly alphabetical.</li> <li>Scope Control: Only document shares or configs we plan to keep. Avoid listing temporary paths.</li> <li>Patch Script &amp; Git Discipline: Use <code>./patch.sh</code> to refresh maps/icons. Start work on a new branch. Commit only tested, working changes. Run <code>git status</code> before and after <code>./patch.sh</code>.</li> <li>Gamified Style: Each chapter ends with a Chapter Complete XP callout; XP is for fun, not tracking.</li> <li>Acronym Hygiene: Expand acronyms on first use in each file, then rely on glossary and abbreviations include for hover tooltips.</li> </ul>"},{"location":"ai-context/#style-theme-baseline","title":"Style &amp; Theme Baseline","text":"<ul> <li>Theme: MkDocs Material. Dark mode default as configured in <code>mkdocs.yml</code>.</li> <li>Headings: One <code>#</code> H1 per page (title). Use <code>##</code> for sections, <code>###</code> for subsections. No deeper than <code>####</code> unless necessary.</li> <li>Tone: Clear, concise, instructional. American English. Avoid slang.</li> <li>Punctuation: No em-dashes or ellipses. Prefer commas or parentheses.</li> <li>Lists: Use <code>-</code> for bullets. Indent nested bullets by two spaces.</li> <li>Code Fences: Always specify a language (<code>bash</code>, <code>yaml</code>, <code>hcl</code>, <code>json</code>, <code>toml</code>, etc.).</li> <li>Tables: Compact. Left-align text. Include a header row.</li> <li>Admonitions: Prefer <code>!!! note</code>, <code>!!! tip</code>, and <code>!!! warning</code> only when they add real value.</li> <li>Links: Use relative links within the repo. Descriptive link text, no bare URLs.</li> <li>Images/Screenshots: Place under <code>docs/assets/</code>. Name as <code>section-topic-shortdesc.png</code>. Reference with relative paths.</li> <li>Abbreviation Tooltips: Ensure the include snippet line is present near the top of each content page.</li> <li>Checklists: Use <code>- [ ]</code> for tasks and exit criteria. Keep concise.</li> <li>Line Hygiene: Wrap lines reasonably. No trailing whitespace.</li> <li>Canonical Section Order: Entry Checks \u2192 Outcomes \u2192 Story Intro \u2192 Labs \u2192 Validation \u2192 Exit Criteria.</li> <li>Story Intro: Open each chapter with 1\u20133 lines of narrative context that ties to the journey (why this step matters).</li> <li>Lab Numbering: Use hierarchical numbering per chapter (e.g., 4.1, 4.2, 4.3). Do not renumber earlier labs when adding new ones; append 4.6, 4.7, etc.</li> <li>Footer Nav Only: Do not include inline \u201c## Next/Previous\u201d sections in pages. Rely on MkDocs Material\u2019s footer navigation.</li> <li>Icons/Emojis: Keep subtle. Use the page front\u2011matter 'icon:' and occasional emojis in intros only.</li> <li>Admonition Titles: Keep short, sentence case (e.g., \"Note\", \"Tip\").</li> </ul>"},{"location":"ai-context/#canonical-page-skeleton","title":"Canonical Page Skeleton","text":"<pre><code>---\nicon: material/&lt;page-icon&gt;\n---\n# &lt;Page Title&gt;\n\n## Entry Checks\n- [ ] &lt;pre-req 1&gt;\n- [ ] &lt;pre-req 2&gt;\n\n## Outcomes\n- &lt;what you will have at the end&gt;\n\n&lt;1\u20133 line Story Intro&gt;\n\n## Labs\n### &lt;chapter&gt;.&lt;lab&gt; &lt;Lab Title&gt;\n- Step bullets\u2026\n### &lt;chapter&gt;.&lt;lab+1&gt; &lt;Lab Title&gt;\n- Step bullets\u2026\n\n## Validation\n- [ ] Checks\u2026\n\n## Exit Criteria\n- [ ] Checks\u2026\n\n&gt; \ud83c\udf89 Chapter Complete! You\u2019ve earned up to XX XP (like Whose Line, the points are made up but the fun is real).\n</code></pre>"},{"location":"ai-context/#navigation-policy","title":"Navigation Policy","text":"<ul> <li>Footer navigation is the source of truth for Previous/Next.</li> <li>Remove any inline navigation blocks from markdown pages.</li> </ul>"},{"location":"ai-context/#ai-prompt-for-new-chat","title":"AI Prompt for New Chat","text":"<p>The following prompt is recommended for starting a new chat with the AI on this repository. It ensures that all changes to <code>docs/ai-context.md</code> are tracked and updated using the correct process, and that AI sessions follow best practices for reliability and reproducibility.</p> <pre><code>When collaborating on this repository:\n- Output the commands to update `docs/ai-context.md` using `./patch.sh` whenever changes are made to this file.\n- Start each new session by creating a new branch.\n- Only add commits and open pull requests for changes that have been tested and are known to work.\n- Periodically check the Git status to ensure that no changes are lost.\n</code></pre>"},{"location":"ai-context/#patch-script-command-template","title":"Patch Script Command Template","text":"<p>This is a ready-to-run sequence the AI should output when updating this file.</p> <pre><code># Create a working branch\ngit checkout -b docs/ai-context-refresh-$(date +%Y%m%d-%H%M)\n\n# Refresh Decision Log and Repo Map via patch script\n./patch.sh --ai \"Decision: Refresh AI Context and Repo Map\"\n\n# Verify repo map and icons after changes\n./patch.sh --verify\n\n# Stage and commit only tested, working changes\ngit add docs/ai-context.md mkdocs.yml .github/workflows/pages.yml docs/ || true\ngit commit -m \"docs: refresh AI Context and Repo Map\"\n\n# Push and open a pull request against main\ngit push -u origin $(git branch --show-current)\ngh pr create -B main -t \"docs: refresh AI Context and Repo Map\" -b \"Automated update using patch.sh --verify\"\n</code></pre> <p>Notes: - Run from the repo root where <code>patch.sh</code> lives. - <code>gh</code> GitHub CLI is optional; if unavailable, open the PR manually. - Run <code>git status</code> before and after <code>./patch.sh</code> to avoid losing untracked changes.</p>"},{"location":"ai-context/#ai-prompt-helper","title":"AI Prompt Helper","text":"<p>Use this prompt to refresh the AI Context file:</p> <pre><code>Review the repo. Summarize new decisions since the last run. Append them under '## Decision Log'. Then regenerate the Repository Map section with current numbered chapter filenames. Clear out older decision entries to keep the file clean.\n</code></pre>"},{"location":"ai-context/#decision-2025-08-31-165454z","title":"Decision \u2014 2025-08-31 16:54:54Z","text":"<p>Decision: Refresh AI Context and Repo Map</p>"},{"location":"ai-context/#repository-map-auto-generated","title":"Repository Map (Auto-generated)","text":"<p>This section is rewritten by <code>patch.sh</code> on each run to reflect the current layout and health checks. Other sections above/below are preserved.</p>"},{"location":"ai-context/#key-directories","title":"Key Directories","text":"<ul> <li><code>docs/</code> \u2014 MkDocs content source.</li> <li><code>docs/01-Hardware.md</code> \u2014 Hardware requirements and planning.</li> <li><code>docs/02-Workstation-Setup.md</code> \u2014 Laptop/desktop tooling installs and verification.</li> <li><code>docs/03-Cloud-Accounts-and-Foundations.md</code> \u2014 HCP Terraform and foundational services bootstrap.</li> <li><code>docs/04-Network-Setup.md</code> \u2014 Network setup and Terraform imports.</li> <li><code>docs/05-NAS-Setup.md</code> \u2014 Storage and backup services.</li> <li><code>docs/06-Proxmox-Cluster-Setup.md</code> \u2014 Proxmox cluster deployment.</li> <li><code>docs/07-CI-CD-for-Terraform.md</code> \u2014 CI/CD pipelines for Terraform workflows.</li> <li><code>docs/08-Image-Factory.md</code> \u2014 Image building and automation.</li> <li><code>docs/09-Core-Infra-VMs.md</code> \u2014 Core VM deployments (Jump Box, PBS, etc).</li> <li><code>docs/10-Docker-Swarm-Cluster.md</code> \u2014 Docker Swarm cluster setup.</li> <li><code>docs/11-Traefik-Authentik-Public-DNS-VPN.md</code> \u2014 Reverse proxy, SSO, public DNS, VPN.</li> <li><code>docs/12-Integration-Pass-1.md</code> \u2014 First integration pass (import resources to TF/Vault/Consul).</li> <li><code>docs/13-Migrations-and-Refactor.md</code> \u2014 State migrations and refactor.</li> <li><code>docs/14-Observability-and-Alerting.md</code> \u2014 Monitoring, logging, and alerting.</li> <li><code>docs/15-Ops-Readiness.md</code> \u2014 Ops readiness, DR, runbooks, SLOs.</li> <li><code>docs/16-Local-DNS.md</code> \u2014 Local DNS (Pi-hole, CoreDNS, Bind).</li> <li><code>docs/17-DMZ-and-Routing.md</code> \u2014 DMZ setup and routing policies.</li> <li><code>docs/18-Public-Status-Page-and-Alerting.md</code> \u2014 Public status page and alerting.</li> <li><code>docs/19-Workloads.md</code> \u2014 Workloads (Plex, Game Servers, Family Photos).</li> <li><code>docs/20-Graduation.md</code> \u2014 Graduation and wrap-up.</li> <li><code>docs/21-Lab-and-Service-Ideas.md</code> \u2014 Backlog of future labs and service ideas.</li> <li><code>docs/runbooks/</code> \u2014 Operational runbooks for maintenance tasks.</li> <li><code>docs/glossary.md</code> \u2014 DAT (Define Acronyms &amp; Terms).</li> <li><code>docs/ai-context.md</code> \u2014 AI decision log and repo map.</li> <li><code>.github/workflows/pages.yml</code> \u2014 GitHub Pages build &amp; deploy pipeline.</li> <li><code>mkdocs.yml</code> \u2014 Site configuration (theme, nav, plugins).</li> <li><code>patch.sh</code> \u2014 Idempotent repo maintainer (icons, nav, AI context, etc).</li> </ul>"},{"location":"ai-context/#expected-files-permissions","title":"Expected Files &amp; Permissions","text":"Item Purpose Exists Perms <code>patch.sh</code> Repo maintainer script \u2705 executable: \u2705 <code>mkdocs.yml</code> MkDocs site config \u2705 readable <code>docs/</code> Documentation root \u2705 readable <code>.github/workflows/pages.yml</code> Pages CI workflow \u2705 readable <code>docs/runbooks/*.md</code> Runbooks content \u2705 readable"},{"location":"ai-context/#quick-tests","title":"Quick Tests","text":"<ul> <li>Serve docs locally: <code>source .venv/bin/activate &amp;&amp; mkdocs serve -a 0.0.0.0:8000</code></li> <li>Build static site: <code>mkdocs build</code></li> <li>Verify theme dark default + icons load on home page.</li> </ul> <p>\ud83c\udf89 AI Context refreshed! You\u2019ve earned +20 XP (like Whose Line, the points are made up but the fun is real).</p>"},{"location":"checklist/","title":"\ud83d\udccb Homelab Docs Alignment Checklist","text":"<p>Quick Overview</p> <p>What: Track style and alignment across all chapters. Why: Ensures consistency, fun, and ADHD-friendly readability. Time: Ongoing; review after editing each doc. XP: +10 per aligned chapter (like Whose Line, the points are made up but the fun is real).</p>"},{"location":"checklist/#alignment-rules","title":"Alignment Rules","text":"<ul> <li>Quick Overview block at the top with What, Why, Time, XP.</li> <li>Entry Checks before Outcomes.</li> <li>Outcomes before story intro.</li> <li>Story intro included.</li> <li>Labs hierarchically numbered (e.g., 4.1, 4.2).</li> <li>Validation under each lab with checklists and \ud83c\udfc6 achievements.</li> <li>Chapter Complete XP callout at the bottom (Whose Line style).</li> <li>Acronyms expanded on first use only.</li> <li>Inline nav removed, footer nav only.</li> </ul>"},{"location":"checklist/#progress","title":"Progress","text":""},{"location":"checklist/#completed","title":"\u2705 Completed","text":"<ul> <li>01-Hardware.md</li> <li>02-Workstation-Setup.md</li> <li>03-Cloud-Accounts-and-Foundations.md</li> <li>04-Network-Setup.md</li> <li>05-NAS-Setup.md</li> <li>06-Proxmox-Cluster-Setup.md</li> <li>index.md</li> <li>glossary.md</li> <li>CONTRIBUTING.md</li> <li>ai-context.md</li> <li>includes/abbreviations.md</li> </ul>"},{"location":"checklist/#pending","title":"\u23f3 Pending","text":"<ul> <li>07-CI-CD-for-Terraform.md</li> <li>08-Image-Factory.md</li> <li>09-Core-Infra-VMs.md</li> <li>10-Docker-Swarm-Cluster.md</li> <li>11-Traefik-Authentik-Public-DNS-VPN.md</li> <li>12-Integration-Pass-1.md</li> <li>13-Migrations-and-Refactor.md</li> <li>14-Observability-and-Alerting.md</li> <li>15-Ops-Readiness.md</li> <li>16-Local-DNS.md</li> <li>17-DMZ-and-Routing.md</li> <li>18-Public-Status-Page-and-Alerting.md</li> <li>19-Workloads.md</li> <li>20-Graduation.md</li> <li>21-Lab-and-Service-Ideas.md</li> </ul> <p>\ud83c\udf89 Checklist updated! Keep aligning chapters and racking up XP (the points don\u2019t matter, but the consistency does).</p> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"glossary/","title":"Glossary (DAT \u2014 Define Acronyms &amp; Terms)","text":"<p>Quick Overview</p> <p>What: Central glossary of acronyms and terms used across the homelab campaign. Why: Quick reference makes the journey smoother. Time: Ongoing; add terms as you go. XP: Infinite points (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this as your hacker\u2019s codex: a living dictionary for all the jargon, acronyms, and tools you\u2019ll encounter in this campaign.</p>"},{"location":"glossary/#hover-definitions","title":"Hover definitions","text":"<p>Hover tooltips are defined centrally in <code>docs/includes/abbreviations.md</code> and injected on every page via <code>hooks.py</code>. When you add a new acronym: 1. Add it here under Terms. 2. Add the same definition to <code>docs/includes/abbreviations.md</code> so hovers work site\u2011wide.</p> <p>This page holds durable context for collaborating with AI on this repo. Entries are appended and never auto-deleted.</p>"},{"location":"glossary/#contributing-glossary-terms","title":"Contributing Glossary Terms","text":"<p>Adding a term = +5 XP (don\u2019t worry, points don\u2019t matter\u2014but your future self will thank you).</p> <p>When adding a new acronym or term:</p> <ol> <li>Add it to the Terms list for readers to browse.</li> <li>Add it to the Abbreviations list so the term will display a hover definition throughout the docs.</li> <li>Keep the definition text exactly the same in both sections to ensure consistency.</li> </ol>"},{"location":"glossary/#terms","title":"Terms","text":"<ul> <li>ACME \u2014 Automated Certificate Management Environment, protocol for automated certificate issuance</li> <li>API \u2014 Application Programming Interface, rules and definitions for software communication</li> <li>CA \u2014 Certificate Authority, entity that issues digital certificates</li> <li>CGNAT \u2014 Carrier-Grade Network Address Translation, ISP technique to share IPv4 addresses</li> <li>CI/CD \u2014 Continuous Integration / Continuous Delivery, automating testing and deployments</li> <li>CLI \u2014 Command-Line Interface, text-based way to interact with systems</li> <li>CPU \u2014 Central Processing Unit, the main processor of a computer</li> <li>Consul \u2014 HashiCorp tool for service discovery and configuration</li> <li>DAT \u2014 Define Acronyms &amp; Terms, the glossary itself</li> <li>DSM \u2014 DiskStation Manager, Synology\u2019s operating system for NAS devices</li> <li>DMZ \u2014 Demilitarized Zone, network segment that adds a layer of security between internal and external networks</li> <li>DNS \u2014 Domain Name System, resolves human-readable names to IPs</li> <li>DR \u2014 Disaster Recovery, processes for restoring systems after failure</li> <li>GB \u2014 Gigabyte, unit of data storage or memory capacity</li> <li>GbE \u2014 Gigabit Ethernet, network standard for 1 gigabit per second speeds</li> <li>Git \u2014 Distributed version control system for tracking changes in source code</li> <li>GPU \u2014 Graphics Processing Unit, processor for graphics and parallel workloads</li> <li>HA \u2014 High Availability, system design to ensure uptime and redundancy</li> <li>IaC \u2014 Infrastructure as Code, managing infra via declarative configs</li> <li>IP \u2014 Internet Protocol, addressing system for networked devices</li> <li>IPv6 \u2014 Internet Protocol version 6, next-generation internet addressing system</li> <li>IoT \u2014 Internet of Things, interconnected devices with network capabilities</li> <li>LUN \u2014 Logical Unit Number, a block storage allocation presented by iSCSI</li> <li>NAS \u2014 Network Attached Storage, dedicated storage appliance on network</li> <li>NFS \u2014 Network File System, protocol for sharing files over a network</li> <li>NIC \u2014 Network Interface Card, hardware for network connectivity</li> <li>NVMe \u2014 Non-Volatile Memory Express, protocol for fast SSDs</li> <li>PBS \u2014 Proxmox Backup Server, backup solution integrated with Proxmox</li> <li>PoE \u2014 Power over Ethernet, delivers power and data over the same cable</li> <li>Portainer \u2014 Web UI for managing Docker containers</li> <li>PR \u2014 Pull Request, a proposed change in GitHub for review/merge</li> <li>Prometheus \u2014 Monitoring and metrics collection system</li> <li>RAID \u2014 Redundant Array of Independent Disks, storage virtualization for redundancy/performance</li> <li>RAM \u2014 Random Access Memory, volatile system memory</li> <li>RJ45 \u2014 Standard connector for Ethernet networking</li> <li>SFP \u2014 Small Form-factor Pluggable, transceiver for network modules</li> <li>SFP+ \u2014 Enhanced Small Form-factor Pluggable, higher-speed transceiver for networking</li> <li>SLOs \u2014 Service Level Objectives, reliability/performance targets linked to SLIs and SLAs</li> <li>SMB \u2014 Server Message Block, protocol for sharing files over a network</li> <li>SSD \u2014 Solid State Drive, fast storage device</li> <li>SSO \u2014 Single Sign-On, authentication system enabling one login for multiple services</li> <li>SSL \u2014 Secure Sockets Layer, cryptographic protocol for encrypted communications (deprecated, succeeded by TLS)</li> <li>TF \u2014 Terraform, HashiCorp tool for IaC</li> <li>UI \u2014 User Interface, the visual/interactive layer for managing systems</li> <li>UPS \u2014 Uninterruptible Power Supply, device providing backup power</li> <li>VLAN \u2014 Virtual LAN, network segmentation for isolating devices</li> <li>VM \u2014 Virtual Machine, emulated computer instance</li> <li>VPN \u2014 Virtual Private Network, secure tunnel for remote access</li> <li>Vault \u2014 HashiCorp tool for secrets management</li> <li>iSCSI \u2014 Internet Small Computer Systems Interface, protocol for linking data storage over IP networks</li> </ul> <p>\ud83c\udf89 Glossary updated! You\u2019ve gained wisdom XP (fun is what matters).</p> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"includes/abbreviations/","title":"Abbreviations","text":"<p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"runbooks/resolve_conflicts/","title":"Resolve Git Merge Conflicts (Runbook)","text":""},{"location":"runbooks/resolve_conflicts/#1-summary","title":"1. Summary","text":"<ul> <li>Purpose: Resolve a simple one-file conflict in a feature branch, keep branch protections intact.</li> <li>Scope: Typical docs conflicts (e.g., <code>mkdocs.yml</code>).</li> </ul>"},{"location":"runbooks/resolve_conflicts/#2-preconditions","title":"2. Preconditions","text":"<ul> <li>Local clone with <code>origin</code> pointing to GitHub.</li> <li>Feature branch checked out, e.g., <code>docs/mkdocs-scaffold</code>.</li> </ul>"},{"location":"runbooks/resolve_conflicts/#3-diagnosis","title":"3. Diagnosis","text":"<ul> <li>PR shows: \"This branch has conflicts that must be resolved\".</li> <li>File shows conflict markers <code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code>, <code>=======</code>, <code>&gt;&gt;&gt;&gt;&gt;&gt;&gt;</code>.</li> </ul>"},{"location":"runbooks/resolve_conflicts/#4-remediation-a-merge-main-into-feature-safe","title":"4. Remediation A \u2014 Merge main into feature (safe)","text":"<pre><code># from your feature branch\ngit fetch origin\ngit merge origin/main\n# edit conflicted files, keep the intended blocks\ngit add mkdocs.yml  # and any others\ngit commit -m \"fix: resolve merge conflicts\"\ngit push\n</code></pre>"},{"location":"runbooks/resolve_conflicts/#5-remediation-b-rebase-feature-onto-main-linear-history","title":"5. Remediation B \u2014 Rebase feature onto main (linear history)","text":"<pre><code>git fetch origin\ngit rebase origin/main\n# resolve conflicts as they arise\ngit add &lt;file&gt;\ngit rebase --continue\n# may require force-with-lease\ngit push --force-with-lease\n</code></pre>"},{"location":"runbooks/resolve_conflicts/#6-validation","title":"6. Validation","text":"<ul> <li>CI checks pass.</li> <li>PR shows \"This branch has no conflicts\".</li> <li>Site builds and renders locally: <code>mkdocs serve -a 0.0.0.0:8000</code>.</li> </ul>"},{"location":"runbooks/resolve_conflicts/#7-notes","title":"7. Notes","text":"<ul> <li>Prefer merge for simplicity on shared branches.</li> <li>Prefer rebase for a clean, linear history on personal branches.</li> </ul> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"},{"location":"runbooks/vault_bootstrap_runbook/","title":"Vault Bootstrap Runbook [Synology NAS, Portainer stack]","text":"<p>Scope: minimal, temporary Vault with Raft storage and TLS. Single node. Non-root uid,gid. Audience: SRE on NAS01. Hostname: <code>vault</code> and <code>vault.SpecterRealm.com</code>.</p>"},{"location":"runbooks/vault_bootstrap_runbook/#tldr","title":"TL,DR","text":"<ul> <li> Confirm container is up, hostname is <code>vault</code>, web UI loads</li> <li> Set env in the Vault container: <code>VAULT_ADDR</code>, <code>VAULT_CACERT</code>, <code>VAULT_TOKEN</code></li> <li> If first run, init then unseal with 3 keys</li> <li> Run <code>scripts/vault/init.sh</code> bootstrap (or <code>/tmp/init.sh</code> inside container if testing), or execute equivalent manual steps below</li> <li> Store unseal shares and root token in M365 Secure Notes</li> <li> Enable audit to file, seed initial secrets, take a Raft snapshot</li> <li> Add the backup paths to Hyper Backup</li> </ul>"},{"location":"runbooks/vault_bootstrap_runbook/#constants","title":"Constants","text":"<ul> <li>Vault URL: <code>https://vault.SpecterRealm.com:8200</code></li> <li>In-container URL: <code>https://vault:8200</code></li> <li>CA and certs in container: <code>/pki/ca.pem</code>, <code>/pki/vault.crt</code>, <code>/pki/vault.key</code></li> <li>Data: <code>/volume1/docker/appdata/vault/data</code></li> <li>Audit: <code>/volume1/docker/appdata/vault/audit</code></li> <li>Config: <code>/volume1/docker/appdata/vault/config/vault.hcl</code></li> <li>Run as <code>user: \"1030:100\"</code>, <code>SKIP_SETCAP=true</code>, <code>disable_mlock=true</code></li> </ul>"},{"location":"runbooks/vault_bootstrap_runbook/#prerequisites","title":"Prerequisites","text":"<ul> <li>Portainer stack deployed with volumes bound to the paths above.</li> <li>TLS files exist and are mounted as files, not a directory.</li> <li>Container hostname set to <code>vault</code> in the stack.</li> <li>The CA that signed <code>vault.crt</code> is present at <code>/pki/ca.pem</code> in the container.</li> </ul> <p>Sanity: <pre><code># inside the vault container shell\nexport VAULT_ADDR=https://vault:8200\nexport VAULT_CACERT=/pki/ca.pem\nvault status || true\n</code></pre></p>"},{"location":"runbooks/vault_bootstrap_runbook/#initialize-and-unseal","title":"Initialize and Unseal","text":"<p>Initialize on first ever run: <pre><code>vault operator init -key-shares=5 -key-threshold=3\n# Save: 5 unseal keys, root token. Store in M365.\n</code></pre></p> <p>Unseal: <pre><code>vault operator unseal    # run 3 times with different keys\nvault status             # should show Sealed=false, Mode=active\n</code></pre></p> <p>Lost root token? Generate a new one: <pre><code>vault operator generate-root -generate-otp\nvault operator generate-root -init -otp=&lt;otp&gt;   # copy Nonce\nvault operator generate-root -nonce=&lt;nonce&gt;     # repeat 3 times, paste different unseal keys\nvault operator generate-root -decode=&lt;encoded_token&gt; -otp=&lt;otp&gt;  # new root token\n</code></pre></p>"},{"location":"runbooks/vault_bootstrap_runbook/#one-shot-bootstrap-script","title":"One-shot Bootstrap Script","text":"<p>Create and run the script inside the vault container.</p> <pre><code>cat &gt; /tmp/init.sh &lt;&lt;'EOF'\n#!/usr/bin/env sh\nset -euo pipefail\n\nVAULT_ADDR=\"${VAULT_ADDR:-https://vault:8200}\"\nVAULT_CACERT=\"${VAULT_CACERT:-/pki/ca.pem}\"\nROOT_TOKEN=\"${VAULT_TOKEN:-}\"\n\nCF_API_TOKEN=\"${CF_API_TOKEN:-}\"          # optional seed\nPG_USER=\"${PG_USER:-svc_app}\"\nPG_PASS=\"${PG_PASS:-}\"                    # optional seed\nPG_URL=\"${PG_URL:-postgres://db:5432/app}\"\n\nif [ -z \"${ROOT_TOKEN}\" ]; then\n  echo \"ERROR: VAULT_TOKEN (root) not set\" &gt;&amp;2\n  exit 1\nfi\n\nexport VAULT_ADDR VAULT_CACERT VAULT_TOKEN=\"${ROOT_TOKEN}\"\n\nvault status || true\n\n# Enable KV v2\nvault secrets list -format=json | grep -q '\"kv/\":' || \\\n  vault secrets enable -path=kv kv-v2\n\n# Policies\ncat &gt;/tmp/admin.hcl &lt;&lt;'POLICY'\npath \"sys/*\"  { capabilities = [\"create\",\"read\",\"update\",\"delete\",\"list\",\"sudo\"] }\npath \"auth/*\" { capabilities = [\"create\",\"read\",\"update\",\"delete\",\"list\",\"sudo\"] }\npath \"kv/*\"   { capabilities = [\"create\",\"read\",\"update\",\"delete\",\"list\"] }\nPOLICY\nvault policy write admin /tmp/admin.hcl\n\ncat &gt;/tmp/service.hcl &lt;&lt;'POLICY'\npath \"kv/data/*\"     { capabilities = [\"read\"] }\npath \"kv/metadata/*\" { capabilities = [\"list\"] }\nPOLICY\nvault policy write service /tmp/service.hcl\n\n# Auth\nvault auth list -format=json | grep -q '\"userpass/\":' || \\\n  vault auth enable userpass\n\nADMIN_PW=\"${ADMIN_PW:-$(head -c 18 /dev/urandom | base64)}\"\nvault write auth/userpass/users/admin password=\"${ADMIN_PW}\" policies=admin\necho \"BOOTSTRAP_ADMIN_USER=admin\"\necho \"BOOTSTRAP_ADMIN_PASS=${ADMIN_PW}\"\n\nif [ -n \"${PG_PASS}\" ] || [ -n \"${CF_API_TOKEN}\" ]; then\n  SVC_PW=\"${SVC_PW:-$(head -c 18 /dev/urandom | base64)}\"\n  vault write auth/userpass/users/svc password=\"${SVC_PW}\" policies=service\n  echo \"SERVICE_USER=svc\"\n  echo \"SERVICE_PASS=${SVC_PW}\"\nfi\n\n# Audit\nmkdir -p /vault/audit\nvault audit list -format=json | grep -q '\"file/\":' || \\\n  vault audit enable file file_path=/vault/audit/audit.log\n\n# Seed secrets\n[ -n \"${CF_API_TOKEN}\" ] &amp;&amp; vault kv put kv/cloudflare/api token=\"${CF_API_TOKEN}\" &amp;&amp; echo \"Seeded: kv/cloudflare/api\"\n[ -n \"${PG_PASS}\" ] &amp;&amp; vault kv put kv/db/postgres username=\"${PG_USER}\" password=\"${PG_PASS}\" url=\"${PG_URL}\" &amp;&amp; echo \"Seeded: kv/db/postgres\"\n\n# Smoke and snapshot\nvault kv put kv/test hello=world &gt;/dev/null\nvault kv get kv/test &gt;/dev/null &amp;&amp; echo \"KV test OK\"\n\nSNAP=/vault/data/bootstrap-$(date +%Y%m%d-%H%M%S).snap\nvault operator raft snapshot save \"${SNAP}\"\necho \"Snapshot: ${SNAP}\"\nEOF\n\nchmod +x /tmp/init.sh\n\n# Required: export VAULT_TOKEN to your current root token\nVAULT_TOKEN=&lt;root-token-here&gt; /tmp/init.sh\n</code></pre> <p>Optional seeds: <pre><code>export CF_API_TOKEN=&lt;CF token&gt;           # optional\nexport PG_PASS=&lt;postgres password&gt;       # optional\nexport PG_USER=svc_app\nexport PG_URL=\"postgres://host:5432/app\"\nVAULT_TOKEN=&lt;root-token&gt; /tmp/init.sh\n</code></pre></p>"},{"location":"runbooks/vault_bootstrap_runbook/#manual-minimal-steps-if-not-using-script","title":"Manual Minimal Steps (if not using script)","text":"<pre><code>export VAULT_ADDR=https://vault:8200\nexport VAULT_CACERT=/pki/ca.pem\nexport VAULT_TOKEN=&lt;root&gt;\n\nvault secrets enable -path=kv kv-v2\n\ncat &gt;/tmp/admin.hcl &lt;&lt;'EOF'\npath \"sys/*\"  { capabilities = [\"create\",\"read\",\"update\",\"delete\",\"list\",\"sudo\"] }\npath \"auth/*\" { capabilities = [\"create\",\"read\",\"update\",\"delete\",\"list\",\"sudo\"] }\npath \"kv/*\"   { capabilities = [\"create\",\"read\",\"update\",\"delete\",\"list\"] }\nEOF\nvault policy write admin /tmp/admin.hcl\n\nvault auth enable userpass\nADMIN_PW=\"$(head -c 18 /dev/urandom | base64)\"; echo \"admin: ${ADMIN_PW}\"\nvault write auth/userpass/users/admin password=\"${ADMIN_PW}\" policies=admin\n\nmkdir -p /vault/audit\nvault audit enable file file_path=/vault/audit/audit.log\n</code></pre>"},{"location":"runbooks/vault_bootstrap_runbook/#backups","title":"Backups","text":"<p>Include in Hyper Backup: - <code>/volume1/docker/appdata/vault/data</code>  [Raft, snapshots] - <code>/volume1/docker/appdata/vault/audit</code> - <code>/volume1/docker/appdata/vault/config</code> - <code>/volume1/docker/appdata/pki</code>  [include <code>ca.key</code> if you want to reissue]</p> <p>Run a snapshot after bootstrap: <pre><code>vault operator raft snapshot save /vault/data/post-bootstrap.snap\n</code></pre></p>"},{"location":"runbooks/vault_bootstrap_runbook/#what-to-save","title":"What to save","text":"<ul> <li>Unseal key shares: all 5. Threshold 3.</li> <li>Current root token.</li> <li>If used: bootstrap <code>admin</code> userpass and <code>svc</code> userpass credentials.</li> <li>Snapshot file names and locations.</li> </ul>"},{"location":"runbooks/vault_bootstrap_runbook/#troubleshooting-quick-hits","title":"Troubleshooting quick hits","text":"<ul> <li> <p>permission denied /vault/data/vault.db   Fix host ownership to 1030:100, ensure parents 755, data 700. Remove stale <code>vault.db</code>, <code>raft/</code>. Clear DSM ACLs if present.</p> </li> <li> <p>mlock failures   Set <code>disable_mlock = true</code> in <code>vault.hcl</code>. For ulimit route, add <code>ulimits: { memlock: -1 }</code> and keep <code>IPC_LOCK</code>.</p> </li> <li> <p>TLS cert not found or permission denied   Bind files individually:   <pre><code>- /volume1/.../pki/vault.crt:/pki/vault.crt:ro\n- /volume1/.../pki/vault.key:/pki/vault.key:ro\n- /volume1/.../pki/ca.pem:/pki/ca.pem:ro\n</code></pre>   Ensure <code>/pki/vault.key</code> is readable by uid 1030.</p> </li> <li> <p>x509 cannot validate 127.0.0.1   Use <code>https://vault:8200</code> inside the container or add IP SANs when minting the cert.</p> </li> <li> <p>CAP_SETFCAP errors when running as 1030   Set <code>SKIP_SETCAP=true</code> in environment.</p> </li> <li> <p>403 permission denied on CLI <code>VAULT_TOKEN</code> not set or wrong. Re-export it or generate a new root with <code>generate-root</code>.</p> </li> </ul>"},{"location":"runbooks/vault_bootstrap_runbook/#restore-runbook","title":"Restore Runbook","text":"<ol> <li>Restore backup folders to the same paths.  </li> <li>Redeploy Portainer stack.  </li> <li>Unseal with any 3 shares.  </li> <li><code>export VAULT_ADDR=https://vault:8200 VAULT_CACERT=/pki/ca.pem</code> </li> <li><code>vault status</code> should show active.  </li> <li>Re-enable audit if the path changed.  </li> <li>Rotate root token. Optionally disable <code>userpass</code> when OIDC is ready.</li> </ol> <p>Quick Overview</p> <p>What: Shared abbreviations and hover tooltips for the campaign. Why: Ensures acronyms and jargon stay consistent across all docs. Time: Ongoing; update whenever a new term is introduced. XP: +5 per new acronym (like Whose Line, the points are made up but the fun is real).</p> <p>Think of this file as your universal translator\u2014every acronym here powers hover definitions site-wide.</p> <p>\ud83c\udf89 Abbreviations updated! You\u2019ve earned +5 XP for each new term (points don\u2019t matter, but consistency does).</p>"}]}